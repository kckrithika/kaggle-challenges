#!/bin/bash -xe

while getopts ":o:" opt; do
  case $opt in
    o)
      OUTPUT_DIR=$OPTARG
      ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      exit 1
      ;;
    :)
      echo "Option -$OPTARG requires an argument." >&2
      exit 1
      ;;
  esac
done

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
PARENT_DIR="$(dirname $SCRIPT_DIR)"
cd $PARENT_DIR

# Disable estates check for now until we work out the access token stuff
/opt/sam/sam-manifest-builder -logtostderr -output $OUTPUT_DIR -estatescheck=false -root .
