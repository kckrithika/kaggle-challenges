apiVersion: v1
data:
  prometheus.json: |-
    {
      "alerting": {
        "alertmanagers": [
          {
            "scheme": "http",
            "static_configs": [
              {
                "targets": []
              }
            ],
            "timeout": "10s"
          }
        ]
      },
      "global": {
        "evaluation_interval": "15s",
        "scrape_interval": "15s",
        "scrape_timeout": "10s"
      },
      "scrape_configs": [
        {
          "job_name": "etcd",
          "scheme": "https",
          "static_configs": [
            {
              "targets": [
                "shared0-samdevkubeapi1-1-prd.eng.sfdc.net:2379",
                "shared0-samdevkubeapi2-1-prd.eng.sfdc.net:2379",
                "shared0-samdevkubeapi3-1-prd.eng.sfdc.net:2379"
              ]
            }
          ],
          "tls_config": {
            "ca_file": "/etc/pki_service/ca/cabundle.pem",
            "cert_file": "/etc/pki_service/etcd/etcd-client/certificates/etcd-client.pem",
            "key_file": "/etc/pki_service/etcd/etcd-client/keys/etcd-client-key.pem"
          }
        },
        {
          "job_name": "kubernetes-apiservers",
          "kubernetes_sd_configs": [
            {
              "api_server": "shared0-samdevkubeapi2-1-prd.eng.sfdc.net:8000",
              "role": "endpoints",
              "tls_config": {
                "ca_file": "/etc/pki_service/ca/cabundle.pem",
                "cert_file": "/etc/pki_service/kubernetes/k8s-client/certificates/k8s-client.pem",
                "key_file": "/etc/pki_service/kubernetes/k8s-client/keys/k8s-client-key.pem"
              }
            }
          ],
          "relabel_configs": [
            {
              "action": "keep",
              "regex": "default;kubernetes;https",
              "source_labels": [
                "__meta_kubernetes_namespace",
                "__meta_kubernetes_service_name",
                "__meta_kubernetes_endpoint_port_name"
              ]
            }
          ],
          "scheme": "https",
          "tls_config": {
            "ca_file": "/etc/pki_service/ca/cabundle.pem",
            "cert_file": "/etc/pki_service/kubernetes/k8s-client/certificates/k8s-client.pem",
            "key_file": "/etc/pki_service/kubernetes/k8s-client/keys/k8s-client-key.pem"
          }
        }
      ]
    }
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: prometheus
  namespace: sam-system
