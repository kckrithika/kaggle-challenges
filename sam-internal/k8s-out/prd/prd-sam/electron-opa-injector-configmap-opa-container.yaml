apiVersion: v1
data:
  electron-opa-container.yaml.template: |-
    containers:
      - name: electron-opa
        image: {{ .Image }}
        {{- if .EnvironmentVars}}
        env:
        {{- range $key, $val := .EnvironmentVars}}
        - name: {{$key}}
          {{- if $val.FieldRefFieldPath}}
          valueFrom:
            fieldRef:
              apiVersion: {{$val.FieldRefApiVersion}}
              fieldPath: {{$val.FieldRefFieldPath}}
          {{- else}}
          value: "{{$val.Value}}"
          {{- end}}
        {{- end}}
        {{- end}}
        ports:
        - name: http
          containerPort: 8181
        livenessProbe:
          httpGet:
            scheme: HTTP
            port: 8181
          initialDelaySeconds: 5
          periodSeconds: 5
        readinessProbe:
          httpGet:
            path: /health?bundle=false
            scheme: HTTP
            port: 8181
          initialDelaySeconds: 5
          periodSeconds: 5
        terminationMessagePolicy: FallbackToLogsOnError
kind: ConfigMap
metadata:
  creationTimestamp: null
  labels:
    app: electron-opa-injector
  name: electron-opa-injector-configs-opa-container
  namespace: authz-injector
