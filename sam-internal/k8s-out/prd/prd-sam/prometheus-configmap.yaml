apiVersion: v1
data:
  prometheus.json: |-
    {
      "alerting": {
        "alertmanagers": [
          {
            "scheme": "http",
            "static_configs": [
              {
                "targets": []
              }
            ],
            "timeout": "10s"
          }
        ]
      },
      "global": {
        "evaluation_interval": "15s",
        "scrape_interval": "15s",
        "scrape_timeout": "10s"
      },
      "scrape_configs": [
        {
          "job_name": "etcd",
          "scheme": "https",
          "static_configs": [
            {
              "targets": [
                "shared0-samkubeapi1-1-prd.eng.sfdc.net:2379",
                "shared0-samkubeapi2-1-prd.eng.sfdc.net:2379",
                "shared0-samkubeapi3-1-prd.eng.sfdc.net:2379"
              ]
            }
          ],
          "tls_config": {
            "ca_file": "/etc/pki_service/ca/cabundle.pem",
            "cert_file": "/etc/pki_service/etcd/etcd-client/certificates/etcd-client.pem",
            "key_file": "/etc/pki_service/etcd/etcd-client/keys/etcd-client-key.pem"
          }
        },
        {
          "job_name": "kubernetes-apiserver",
          "scheme": "https",
          "static_configs": [
            {
              "targets": [
                "shared0-samkubeapi1-1-prd.eng.sfdc.net:6443",
                "shared0-samkubeapi2-1-prd.eng.sfdc.net:6443",
                "shared0-samkubeapi3-1-prd.eng.sfdc.net:6443"
              ]
            }
          ],
          "tls_config": {
            "ca_file": "/etc/pki_service/ca/cabundle.pem",
            "cert_file": "/etc/pki_service/kubernetes/k8s-client/certificates/k8s-client.pem",
            "key_file": "/etc/pki_service/kubernetes/k8s-client/keys/k8s-client-key.pem"
          }
        },
        {
          "job_name": "kubernetes-controller-manager",
          "scheme": "http",
          "static_configs": [
            {
              "targets": [
                "shared0-samkubeapi1-1-prd.eng.sfdc.net:10252",
                "shared0-samkubeapi2-1-prd.eng.sfdc.net:10252",
                "shared0-samkubeapi3-1-prd.eng.sfdc.net:10252"
              ]
            }
          ]
        },
        {
          "job_name": "kubernetes-scheduler",
          "scheme": "http",
          "static_configs": [
            {
              "targets": [
                "shared0-samkubeapi1-1-prd.eng.sfdc.net:10251",
                "shared0-samkubeapi2-1-prd.eng.sfdc.net:10251",
                "shared0-samkubeapi3-1-prd.eng.sfdc.net:10251"
              ]
            }
          ]
        },
        {
          "job_name": "kubernetes-kubelet",
          "kubernetes_sd_configs": [
            {
              "api_server": "shared0-samkubeapi2-1-prd.eng.sfdc.net:8000",
              "role": "node",
              "tls_config": {
                "ca_file": "/etc/pki_service/ca/cabundle.pem",
                "cert_file": "/etc/pki_service/kubernetes/k8s-client/certificates/k8s-client.pem",
                "key_file": "/etc/pki_service/kubernetes/k8s-client/keys/k8s-client-key.pem"
              }
            }
          ],
          "relabel_configs": [
            {
              "action": "labelmap",
              "regex": "__meta_kubernetes_node_label_(.+)"
            },
            {
              "replacement": "${1}:10250",
              "source_labels": [
                "__meta_kubernetes_node_name"
              ],
              "target_label": "__address__"
            }
          ],
          "scheme": "https",
          "tls_config": {
            "ca_file": "/etc/pki_service/ca/cabundle.pem",
            "cert_file": "/etc/pki_service/kubernetes/k8s-client/certificates/k8s-client.pem",
            "key_file": "/etc/pki_service/kubernetes/k8s-client/keys/k8s-client-key.pem"
          }
        },
        {
          "job_name": "cadvisor",
          "kubernetes_sd_configs": [
            {
              "api_server": "shared0-samkubeapi2-1-prd.eng.sfdc.net:8000",
              "role": "node",
              "tls_config": {
                "ca_file": "/etc/pki_service/ca/cabundle.pem",
                "cert_file": "/etc/pki_service/kubernetes/k8s-client/certificates/k8s-client.pem",
                "key_file": "/etc/pki_service/kubernetes/k8s-client/keys/k8s-client-key.pem"
              }
            }
          ],
          "relabel_configs": [
            {
              "action": "labelmap",
              "regex": "__meta_kubernetes_node_label_(.+)"
            },
            {
              "replacement": "${1}:4194",
              "source_labels": [
                "__meta_kubernetes_node_name"
              ],
              "target_label": "__address__"
            }
          ],
          "scheme": "http"
        }
      ]
    }
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: prometheus
  namespace: sam-system
