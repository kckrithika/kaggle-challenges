apiVersion: v1
items:
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-frf
      sam.data.sfdc.net/owner: slb
    name: slb-portal-frf
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-frf
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-frf
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-frf
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=frf-sam.frf
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-frf
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-frf
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-frf
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-frf
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-frf/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=frf-sam.frf
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/frf-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-frf
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-frf
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-frf
          - --log_dir=/host/data/slb/logs/slb-portal-frf
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-frf/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-frf/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-frf
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-frf/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-frf
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-frf
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-frf
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-frf/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-frf
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-frf
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-frf
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-frf/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=frf-sam.frf
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-frf
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-frf
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-frf/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-phx
      sam.data.sfdc.net/owner: slb
    name: slb-portal-phx
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-phx
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-phx
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-phx
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=phx-sam.phx
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-phx
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-phx
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-phx
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-phx
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-phx/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=phx-sam.phx
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/phx-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-phx
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-phx
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-phx
          - --log_dir=/host/data/slb/logs/slb-portal-phx
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-phx/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-phx/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-phx
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-phx/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-phx
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-phx
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-phx
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-phx/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-phx
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-phx
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-phx
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-phx/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=phx-sam.phx
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-phx
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-phx
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-phx/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-iad
      sam.data.sfdc.net/owner: slb
    name: slb-portal-iad
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-iad
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-iad
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-iad
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=iad-sam.iad
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-iad
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-iad
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-iad
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-iad
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-iad/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=iad-sam.iad
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/iad-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-iad
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-iad
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-iad
          - --log_dir=/host/data/slb/logs/slb-portal-iad
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-iad/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-iad/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-iad
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-iad/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-iad
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-iad
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-iad
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-iad/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-iad
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-iad
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-iad
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-iad/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=iad-sam.iad
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-iad
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-iad
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-iad/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-ord
      sam.data.sfdc.net/owner: slb
    name: slb-portal-ord
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-ord
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-ord
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-ord
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=ord-sam.ord
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-ord
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-ord
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-ord
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-ord
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ord/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=ord-sam.ord
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/ord-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ord
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ord
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-ord
          - --log_dir=/host/data/slb/logs/slb-portal-ord
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ord/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ord/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-ord
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-ord/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-ord
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ord
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ord
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-ord/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-ord
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-ord
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-ord
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ord/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=ord-sam.ord
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-ord
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-ord
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-ord/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-dfw
      sam.data.sfdc.net/owner: slb
    name: slb-portal-dfw
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-dfw
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-dfw
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-dfw
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=dfw-sam.dfw
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-dfw
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-dfw
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-dfw
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-dfw
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-dfw/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=dfw-sam.dfw
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/dfw-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-dfw
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-dfw
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-dfw
          - --log_dir=/host/data/slb/logs/slb-portal-dfw
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-dfw/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-dfw/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-dfw
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-dfw/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-dfw
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-dfw
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-dfw
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-dfw/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-dfw
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-dfw
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-dfw
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-dfw/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=dfw-sam.dfw
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-dfw
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-dfw
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-dfw/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-hnd
      sam.data.sfdc.net/owner: slb
    name: slb-portal-hnd
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-hnd
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-hnd
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-hnd
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=hnd-sam.hnd
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-hnd
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-hnd
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-hnd
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-hnd
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-hnd/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=hnd-sam.hnd
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/hnd-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-hnd
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-hnd
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-hnd
          - --log_dir=/host/data/slb/logs/slb-portal-hnd
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-hnd/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-hnd/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-hnd
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-hnd/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-hnd
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-hnd
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-hnd
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-hnd/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-hnd
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-hnd
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-hnd
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-hnd/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=hnd-sam.hnd
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-hnd
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-hnd
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-hnd/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-xrd
      sam.data.sfdc.net/owner: slb
    name: slb-portal-xrd
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-xrd
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-xrd
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-xrd
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=xrd-sam.xrd
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-xrd
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-xrd
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-xrd
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-xrd
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-xrd/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=xrd-sam.xrd
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/xrd-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-xrd
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-xrd
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-xrd
          - --log_dir=/host/data/slb/logs/slb-portal-xrd
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-xrd/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-xrd/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-xrd
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-xrd/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-xrd
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-xrd
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-xrd
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-xrd/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-xrd
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-xrd
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-xrd
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-xrd/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=xrd-sam.xrd
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-xrd
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-xrd
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-xrd/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-cdg
      sam.data.sfdc.net/owner: slb
    name: slb-portal-cdg
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-cdg
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-cdg
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-cdg
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=cdg-sam.cdg
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-cdg
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-cdg
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-cdg
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-cdg
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-cdg/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=cdg-sam.cdg
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/cdg-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-cdg
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-cdg
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-cdg
          - --log_dir=/host/data/slb/logs/slb-portal-cdg
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-cdg/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-cdg/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-cdg
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-cdg/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-cdg
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-cdg
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-cdg
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-cdg/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-cdg
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-cdg
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-cdg
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-cdg/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=cdg-sam.cdg
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-cdg
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-cdg
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-cdg/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-fra
      sam.data.sfdc.net/owner: slb
    name: slb-portal-fra
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-fra
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-fra
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-fra
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=fra-sam.fra
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-fra
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-fra
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-fra
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-fra
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-fra/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=fra-sam.fra
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/fra-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-fra
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-fra
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-fra
          - --log_dir=/host/data/slb/logs/slb-portal-fra
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-fra/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-fra/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-fra
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-fra/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-fra
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-fra
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-fra
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-fra/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-fra
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-fra
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-fra
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-fra/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=fra-sam.fra
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-fra
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-fra
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-fra/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-ia2
      sam.data.sfdc.net/owner: slb
    name: slb-portal-ia2
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-ia2
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-ia2
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-ia2
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=ia2-sam.ia2
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-ia2
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-ia2
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-ia2
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-ia2
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ia2/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=ia2-sam.ia2
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/ia2-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ia2
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia2
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-ia2
          - --log_dir=/host/data/slb/logs/slb-portal-ia2
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ia2/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ia2/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia2
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-ia2/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-ia2
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ia2
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia2
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-ia2/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-ia2
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-ia2
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-ia2
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ia2/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=ia2-sam.ia2
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-ia2
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-ia2
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-ia2/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-ph2
      sam.data.sfdc.net/owner: slb
    name: slb-portal-ph2
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-ph2
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-ph2
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-ph2
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=ph2-sam.ph2
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-ph2
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-ph2
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-ph2
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-ph2
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ph2/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=ph2-sam.ph2
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/ph2-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ph2
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ph2
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-ph2
          - --log_dir=/host/data/slb/logs/slb-portal-ph2
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ph2/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ph2/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-ph2
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-ph2/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-ph2
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ph2
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ph2
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-ph2/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-ph2
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-ph2
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-ph2
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ph2/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=ph2-sam.ph2
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-ph2
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-ph2
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-ph2/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-par
      sam.data.sfdc.net/owner: slb
    name: slb-portal-par
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-par
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-par
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-par
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=par-sam.par
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-par
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-par
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-par
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-par
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-par/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=par-sam.par
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/par-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-par
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-par
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-par
          - --log_dir=/host/data/slb/logs/slb-portal-par
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-par/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-par/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-par
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-par/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-par
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-par
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-par
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-par/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-par
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-par
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-par
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-par/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=par-sam.par
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-par
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-par
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-par/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-ukb
      sam.data.sfdc.net/owner: slb
    name: slb-portal-ukb
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-ukb
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-ukb
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-ukb
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=ukb-sam.ukb
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-ukb
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-ukb
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-ukb
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-ukb
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ukb/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=ukb-sam.ukb
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/ukb-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ukb
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ukb
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-ukb
          - --log_dir=/host/data/slb/logs/slb-portal-ukb
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ukb/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ukb/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-ukb
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-ukb/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-ukb
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ukb
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ukb
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-ukb/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-ukb
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-ukb
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-ukb
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ukb/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=ukb-sam.ukb
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-ukb
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-ukb
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-ukb/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-lo2
      sam.data.sfdc.net/owner: slb
    name: slb-portal-lo2
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-lo2
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-lo2
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-lo2
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=lo2-sam.lo2
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-lo2
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-lo2
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-lo2
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-lo2
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-lo2/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=lo2-sam.lo2
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/lo2-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-lo2
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-lo2
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-lo2
          - --log_dir=/host/data/slb/logs/slb-portal-lo2
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-lo2/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-lo2/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-lo2
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-lo2/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-lo2
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-lo2
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-lo2
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-lo2/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-lo2
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-lo2
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-lo2
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-lo2/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=lo2-sam.lo2
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-lo2
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-lo2
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-lo2/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-lo3
      sam.data.sfdc.net/owner: slb
    name: slb-portal-lo3
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-lo3
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-lo3
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-lo3
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=lo3-sam.lo3
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-lo3
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-lo3
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-lo3
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-lo3
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-lo3/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=lo3-sam.lo3
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/lo3-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-lo3
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-lo3
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-lo3
          - --log_dir=/host/data/slb/logs/slb-portal-lo3
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-lo3/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-lo3/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-lo3
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-lo3/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-lo3
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-lo3
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-lo3
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-lo3/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-lo3
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-lo3
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-lo3
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-lo3/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=lo3-sam.lo3
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-lo3
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-lo3
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-lo3/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-ia4
      sam.data.sfdc.net/owner: slb
    name: slb-portal-ia4
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-ia4
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-ia4
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-ia4
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=ia4-sam.ia4
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-ia4
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-ia4
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-ia4
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-ia4
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ia4/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=ia4-sam.ia4
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/ia4-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ia4
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia4
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-ia4
          - --log_dir=/host/data/slb/logs/slb-portal-ia4
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ia4/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ia4/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia4
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-ia4/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-ia4
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ia4
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia4
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-ia4/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-ia4
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-ia4
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-ia4
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ia4/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=ia4-sam.ia4
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-ia4
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-ia4
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-ia4/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      name: slb-portal-ia5
      sam.data.sfdc.net/owner: slb
    name: slb-portal-ia5
    namespace: sam-system
  spec:
    minReadySeconds: 30
    replicas: 1
    selector:
      matchLabels:
        name: slb-portal-ia5
        sam.data.sfdc.net/owner: slb
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        annotations:
          madkub.sam.sfdc.net/allcerts: |-
            {
             "certreqs": [
              {
               "cert-type": "client",
               "kingdom": "prd",
               "name": "cert3",
               "role": "slb.internal"
              }
             ]
            }
        labels:
          name: slb-portal-ia5
          sam.data.sfdc.net/owner: slb
        namespace: sam-system
      spec:
        affinity:
          podAntiAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                - key: name
                  operator: In
                  values:
                  - slb-ipvs
              topologyKey: kubernetes.io/hostname
        containers:
        - command:
          - /sdn/slb-portal
          - --hostname=$(NODE_NAME)
          - --templatePath=/sdn/webfiles
          - --port=9112
          - --client.serverInterface=lo
          - --keyfile=/cert3/client/keys/client-key.pem
          - --certfile=/cert3/client/certificates/client.pem
          - --log_dir=/host/data/slb/logs/slb-portal-ia5
          - --cafile=/cert3/ca/cabundle.pem
          - --aggregatedPortal=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --vipdnsoptions.viplocation=ia5-sam.ia5
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --client.socketDir=/host/data/slb/config/slb-portal-ia5
          - --client.dialSocket=true
          env:
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /healthz
              port: 9112
            initialDelaySeconds: 900
            periodSeconds: 10
            timeoutSeconds: 3
          name: slb-portal-ia5
          resources:
            limits:
              sam.sfdc.net/ip-address: "1"
            requests:
              sam.sfdc.net/ip-address: "1"
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /data/certs
            name: certs
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /config
            name: config
          - mountPath: /cert3
            name: cert3
        - command:
          - /sdn/slb-config-processor
          - --configDir=/host/data/slb/config/slb-portal-ia5
          - --period=1800s
          - --vipsToAcl=
          - --podPhaseCheck=true
          - --namespace=
          - --podstatus=running
          - --subnet=10.251.196.0/22,10.254.251.0/25
          - --k8sapiserver=
          - --serviceList=csrlb,controlplane-ptest
          - --useVipLabelToSelectSvcs=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --log_dir=/host/data/slb/logs/slb-portal-ia5
          - --sleepTime=100ms
          - --livenessProbePort=9876
          - --shouldRemoveConfig=true
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --proxySelectorLabelValue=slb-nginx-config-b
          - --hostnameOverride=$(NODE_NAME)
          - --servicesToLbOverride=
          - --servicesNotToLbOverride=illumio-proxy-svc,illumio-dsr-nonhost-svc,illumio-dsr-host-svc
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ia5/slb-config-proc.sentinel
          - --vipdnsoptions.viplocation=ia5-sam.ia5
          - --k8sapiserver=http://pseudo-kubeapi.csc-sam.prd-sam.prd.slb.sfdc.net:40001/ia5-sam
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          livenessProbe:
            httpGet:
              path: /liveness-probe
              port: 9876
            initialDelaySeconds: 600
            periodSeconds: 30
            timeoutSeconds: 5
          name: slb-config-processor
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ia5
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia5
            name: var-logs-volume
          - mountPath: /data/certs
            name: certs
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /proxyconfig
            name: proxyconfig
        - command:
          - /sdn/slb-node-api
          - --port=9130
          - --configDir=/host/data/slb/config/slb-portal-ia5
          - --log_dir=/host/data/slb/logs/slb-portal-ia5
          - --netInterface=lo
          - --checkSentinel=true
          - --control.configProcSentinel=/host/data/slb/config/slb-portal-ia5/slb-config-proc.sentinel
          - --control.sentinelExpiration=1800s
          - --listenOnSocket=true
          - --readOnly=false
          - --checkMwSentinel=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ia5/slb-manifest-watcher.sentinel
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-node-api
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia5
            name: var-logs-volume
        - command:
          - /sdn/slb-cleanup
          - --period=1800s
          - --logsMaxAge=48h
          - --log_dir=/host/data/slb/logs/slb-portal-ia5/cleanup
          - --filesDirToCleanup=/host/data/slb/logs/slb-portal-ia5
          - --shouldSkipServiceRecords=false
          - --shouldNotDeleteAllFiles=false
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-cleanup
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /host/data/slb/config/slb-portal-ia5
            name: var-config-volume
          - mountPath: /host/data/slb/logs/slb-portal-ia5
            name: var-logs-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /host/data/slb/logs/slb-portal-ia5/cleanup
            name: var-cleanup-logs-volume
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          - --refresher
          - --run-init-for-refresher-mode
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-refresher
          resources: {}
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        - command:
          - /sdn/slb-manifest-watcher
          - --manifestOutputDir=/host/data/slb/manifests/slb-portal-ia5
          - --tnrpEndpoint=https://ops0-piperepo1-0-prd.data.sfdc.net/
          - --hostnameOverride=$(NODE_NAME)
          - --log_dir=/host/data/slb/logs/slb-portal-ia5
          - --hostsConfigFile=/sfdchosts/hosts.json
          - --client.socketDir=/host/data/slb/config/slb-portal-ia5
          - --client.dialSocket=true
          - --maxDeleteLimit=400
          - --isRoleUsed=true
          - --metricsEndpoint=ajna0-funnel1-0-prd.data.sfdc.net:80
          - --vcioptions.strict=false
          - --client.allowStale=true
          - --control.manifestWatcherSentinel=/host/data/slb/config/slb-portal-ia5/slb-manifest-watcher.sentinel
          - --vipdnsoptions.viplocation=ia5-sam.ia5
          env:
          - name: KUBECONFIG
            value: /kubeconfig/kubeconfig-platform
          - name: NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-dva-rc/dva/slb/hyperslb:2304-4f353e811f709c6181798d473ac815ca42d6ab53
          name: slb-manifest-watcher
          securityContext:
            privileged: true
          volumeMounts:
          - mountPath: /host/data/slb
            name: var-slb-volume
          - mountPath: /sfdchosts
            name: sfdchosts
          - mountPath: /kubeconfig
            name: kubeconfig
          - mountPath: /etc/pki_service
            name: maddog-certs
          - mountPath: /proxyconfig
            name: proxyconfig
        dnsPolicy: Default
        initContainers:
        - args:
          - /sam/madkub-client
          - --madkub-endpoint=https://$(MADKUBSERVER_SERVICE_HOST):32007
          - --maddog-endpoint=https://all.pkicontroller.pki.blank.prd.prod.non-estates.sfdcsd.net:8443
          - --maddog-server-ca=/maddog-certs/ca/security-ca.pem
          - --madkub-server-ca=/maddog-certs/ca/cacerts.pem
          - --cert-folders=cert3:/cert3/
          - --token-folder=/tokens/
          - --requested-cert-type=client
          - --ca-folder=/maddog-certs/ca
          env:
          - name: MADKUB_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          - name: MADKUB_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: MADKUB_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/docker-release-candidate/tnrp/sam/madkub:1.0.0-0000082-3d5c21b4
          imagePullPolicy: IfNotPresent
          name: madkub-init
          volumeMounts:
          - mountPath: /cert3
            name: cert3
          - mountPath: /maddog-certs/
            name: maddog-certs
          - mountPath: /tokens
            name: tokens
        nodeSelector:
          pool: prd-slb
        terminationGracePeriodSeconds: 5
        volumes:
        - hostPath:
            path: /data/slb
          name: var-slb-volume
        - hostPath:
            path: /etc/pki_service
          name: maddog-certs
        - hostPath:
            path: /data/slb/config/slb-portal-ia5
          name: var-config-volume
        - hostPath:
            path: /data/slb/logs/slb-portal-ia5
          name: var-logs-volume
        - configMap:
            name: sfdchosts
          name: sfdchosts
        - hostPath:
            path: /data/certs
          name: certs
        - hostPath:
            path: /etc/kubernetes
          name: kubeconfig
        - hostPath:
            path: /data/slb/logs/slb-portal-ia5/cleanup
          name: var-cleanup-logs-volume
        - configMap:
            name: slb-proxy-configuration
          name: proxyconfig
        - configMap:
            name: slb-portal-links
          name: config
        - emptyDir:
            medium: Memory
          name: cert3
        - emptyDir:
            medium: Memory
          name: tokens
kind: List
metadata: {}
