apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: synthetic-dns-check
  namespace: flowsnake
spec:
  replicas: 5
  selector:
    matchLabels:
      name: synthetic-dns-check
  template:
    metadata:
      labels:
        flowsnakeOwner: dva-transform
        flowsnakeRole: FlowsnakeSyntheticDnsCheck
        name: synthetic-dns-check
    spec:
      containers:
      - command:
        - /bin/sh
        - /var/run/check-dns/check-dns.sh
        - dig_kubedns
        - "100"
        image: dva-registry.internal.salesforce.com/dva/sfdc_centos7_jdk8:latest
        name: dig-kubedns
        volumeMounts:
        - mountPath: /hostetc
          name: etc
          readOnly: true
        - mountPath: /var/run/check-dns
          name: check-dns
          readOnly: true
      restartPolicy: Always
      volumes:
      - hostPath:
          path: /etc
        name: etc
      - configMap:
          name: synthetic-dns-check
        name: check-dns
