apiVersion: v1
data:
  ops-adhoc.sh: |
    #!/bin/bash -xe

    hostname=$(hostname)

    # This does an in-place change to the file
    sed -i "s/server: https:.*/server: https:\/\/$HOSTNAME:8000/" /kubeconfig/kubeconfig

    # Keep this running so we dont create a crash loop backoff
    while true; do sleep 10000; done
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: ops-adhoc
  namespace: sam-system
