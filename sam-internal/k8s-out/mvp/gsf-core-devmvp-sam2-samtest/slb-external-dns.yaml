apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  labels:
    name: slb-external-dns
    pcn: deploy
    sam_app: devmvp-dns-register
  name: slb-external-dns
  namespace: sam-system
spec:
  minReadySeconds: 30
  replicas: 1
  selector:
    matchLabels:
      name: slb-external-dns
      pcn: deploy
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        name: slb-external-dns
        pcn: deploy
      namespace: sam-system
    spec:
      containers:
      - args:
        - --source=service
        - --google-project=netsec-222617
        - --registry=txt
        - --txt-owner-id=slb
        - --provider=google
        - --domain-filter=sfdc.net.
        - --log-level=debug
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /var/secrets/google/key.json
        - name: SFDCLOC_PCN_KINGDOM
          value: mvp
        - name: SFDCLOC_PCN_ESTATE
          value: gsf-core-devmvp-sam2-samtest
        - name: KUBECONFIG
          value: ""
        image: gcr.io/gsf-core-devmvp-sam2/rgade/external-dns@sha256:f395ba72e53d9c1e8851461af82da3bd215240bacddde3e7843058dc5cea76c2
        name: slb-external-dns
        volumeMounts:
        - mountPath: /var/secrets/google
          name: google-cloud-key
      nodeSelector:
        pool: gsf-core-devmvp-sam2-samtest
      serviceAccount: sam-stack-edit
      serviceAccountName: sam-stack-edit
      volumes:
      - name: google-cloud-key
        secret:
          secretName: cloud-dns-key
