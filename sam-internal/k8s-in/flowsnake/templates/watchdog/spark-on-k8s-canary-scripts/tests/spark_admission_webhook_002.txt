{"class": "SPARK_SUBMIT_FAILED", "exception": "KubernetesClientException", "exception_cause": "SPARK_ADMISSION_WEBHOOK"}
0522 08:14:44 [1558512884] spark-impersonation-0536bbcd - ======== Beginning spark-impersonation-0536bbcd test ========
0522 08:14:44 [1558512884] spark-impersonation-0536bbcd -  [0;32mKubernetes master [0m is running at  [0;33mhttps://kubernetes-api-flowsnake-yul.data.sfdc.net [0m
0522 08:14:44 [1558512884] spark-impersonation-0536bbcd -
0522 08:14:44 [1558512884] spark-impersonation-0536bbcd - To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.
0522 08:14:45 [1558512885] spark-impersonation-0536bbcd - Cleaning up SparkApplication/Pod older than 1 hours from prior runs.
0522 08:14:46 [1558512886] spark-impersonation-0536bbcd - Creating SparkApplication spark-impersonation-0536bbcd
0522 08:14:46 [1558512886] spark-impersonation-0536bbcd - sparkapplication "spark-impersonation-0536bbcd" created
0522 08:14:48 [1558512888] spark-impersonation-0536bbcd - Waiting for SparkApplication spark-impersonation-0536bbcd to reach a terminal state.
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SparkApplication spark-impersonation-0536bbcd has terminated after 4 seconds. State is SUBMISSION_FAILED.
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - ---- Begin Events ----
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - Name:         spark-impersonation-0536bbcd
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - Events:
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   Type     Reason                            Age   From            Message
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   ----     ------                            ----  ----            -------
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   Normal   SparkApplicationAdded             6s    spark-operator  SparkApplication spark-impersonation-0536bbcd was added, enqueuing it for submission
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   Normal   SparkApplicationAdded             6s    spark-operator  SparkApplication spark-impersonation-0536bbcd was added, enqueuing it for submission
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   Warning  SparkApplicationSubmissionFailed  3s    spark-operator  failed to submit SparkApplication spark-impersonation-0536bbcd: failed to run spark-submit for SparkApplication flowsnake-watchdog/spark-impersonation-0536bbcd: SLF4J: Class path contains multiple SLF4J bindings.
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: Found binding in [jar:file:/opt/spark/jars/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: Found binding in [jar:file:/usr/local/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - Exception in thread "main" io.fabric8.kubernetes.client.KubernetesClientException: Failure executing: POST at: https://10.254.208.1/api/v1/namespaces/flowsnake-watchdog/pods. Message: Internal error occurred: failed calling admission webhook "webhook.sparkoperator.k8s.io": Post https://spark-webhook.flowsnake.svc:443/webhook: dial tcp 10.254.215.218:443: getsockopt: connection refused. Received status: Status(apiVersion=v1, code=500, details=StatusDetails(causes=[StatusCause(field=null, message=failed calling admission webhook "webhook.sparkoperator.k8s.io": Post https://spark-webhook.flowsnake.svc:443/webhook: dial tcp 10.254.215.218:443: getsockopt: connection refused, reason=null, additionalProperties={})], group=null, kind=null, name=null, retryAfterSeconds=null, uid=null, additionalProperties={}), kind=Status, message=Internal error occurred: failed calling admission webhook "webhook.sparkoperator.k8s.io": Post https://spark-webhook.flowsnake.svc:443/webhook: dial tcp 10.254.215.218:443: getsockopt: connection refused, metadata=ListMeta(resourceVersion=null, selfLink=null, additionalProperties={}), reason=InternalError, status=Failure, additionalProperties={}).
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at io.fabric8.kubernetes.client.dsl.base.OperationSupport.requestFailure(OperationSupport.java:470)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at io.fabric8.kubernetes.client.dsl.base.OperationSupport.assertResponseCode(OperationSupport.java:409)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:379)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:343)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleCreate(OperationSupport.java:226)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at io.fabric8.kubernetes.client.dsl.base.BaseOperation.handleCreate(BaseOperation.java:769)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:356)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:141)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:140)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.k8s.submit.Client.run(KubernetesClientApplication.scala:140)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:250)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:241)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.run(KubernetesClientApplication.scala:241)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.start(KubernetesClientApplication.scala:204)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:849)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:167)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:195)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:924)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:933)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -            at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   Warning  SparkApplicationFailed  2s  spark-operator  SparkApplication spark-impersonation-0536bbcd failed: failed to run spark-submit for SparkApplication flowsnake-watchdog/spark-impersonation-0536bbcd: SLF4J: Class path contains multiple SLF4J bindings.
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: Found binding in [jar:file:/opt/spark/jars/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: Found binding in [jar:file:/usr/local/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd - Exception in thread "main" io.fabric8.kubernetes.client.KubernetesClientException: Failure executing: POST at: https://10.254.208.1/api/v1/namespaces/flowsnake-watchdog/pods. Message: Internal error occurred: failed calling admission webhook "webhook.sparkoperator.k8s.io": Post https://spark-webhook.flowsnake.svc:443/webhook: dial tcp 10.254.215.218:443: getsockopt: connection refused. Received status: Status(apiVersion=v1, code=500, details=StatusDetails(causes=[StatusCause(field=null, message=failed calling admission webhook "webhook.sparkoperator.k8s.io": Post https://spark-webhook.flowsnake.svc:443/webhook: dial tcp 10.254.215.218:443: getsockopt: connection refused, reason=null, additionalProperties={})], group=null, kind=null, name=null, retryAfterSeconds=null, uid=null, additionalProperties={}), kind=Status, message=Internal error occurred: failed calling admission webhook "webhook.sparkoperator.k8s.io": Post https://spark-webhook.flowsnake.svc:443/webhook: dial tcp 10.254.215.218:443: getsockopt: connection refused, metadata=ListMeta(resourceVersion=null, selfLink=null, additionalProperties={}), reason=InternalError, status=Failure, additionalProperties={}).
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at io.fabric8.kubernetes.client.dsl.base.OperationSupport.requestFailure(OperationSupport.java:470)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at io.fabric8.kubernetes.client.dsl.base.OperationSupport.assertResponseCode(OperationSupport.java:409)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:379)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleResponse(OperationSupport.java:343)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at io.fabric8.kubernetes.client.dsl.base.OperationSupport.handleCreate(OperationSupport.java:226)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at io.fabric8.kubernetes.client.dsl.base.BaseOperation.handleCreate(BaseOperation.java:769)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:356)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:141)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.k8s.submit.Client$$anonfun$run$2.apply(KubernetesClientApplication.scala:140)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.k8s.submit.Client.run(KubernetesClientApplication.scala:140)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:250)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication$$anonfun$run$5.apply(KubernetesClientApplication.scala:241)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2543)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.run(KubernetesClientApplication.scala:241)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.start(KubernetesClientApplication.scala:204)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:849)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:167)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:195)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:924)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:933)
0522 08:14:52 [1558512892] spark-impersonation-0536bbcd -   at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
0522 08:14:57 [1558512897] spark-impersonation-0536bbcd - ---- End Events ----
0522 08:14:57 [1558512897] spark-impersonation-0536bbcd - Cannot locate driver pod. Maybe it never started? No logs to display.
0522 08:14:57 [1558512897] spark-impersonation-0536bbcd - -------- Executor Pods ----------
0522 08:14:58 [1558512898] spark-impersonation-0536bbcd - Cleaning up stuff for complated or failed test.
0522 08:14:58 [1558512898] spark-impersonation-0536bbcd - sparkapplication "spark-impersonation-0536bbcd" deleted
0522 08:15:02 [1558512902] spark-impersonation-0536bbcd - ======== Completion of spark-impersonation-0536bbcd test, returning 1 ========
