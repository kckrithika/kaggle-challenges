apiVersion: v1

system:
  functions:
  - name: samreport
    count: 1
#    hostnetwork: true
    containers:
    - name: samreport
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/thargrove/hypersam:20170329_144601.7c1b360.clean.thargrove-ltm1
      command: ["/sam/sam-daily-report"]
      args:
        - --tokenfile /var/secrets/token.txt
      ports:
      - containerPort: 64122
      livenessProbe:
        httpGet:
          path: /probe
          port: 64122
      volumeMounts:
        - mountPath: /var/secrets
          name: secretvol
          readOnly: true
    volumes:
    - name: secretvol
      secret:
        secretName: gittoken
  loadbalancers:
  - lbname: samdrlb
    function: samreport
    nodeExposed: true
    ports:
      - port: 64122
        targetport: 64122
