apiVersion: v1

system:
  notifications:
    email:
      - thargrove@salesforce.com
  functions:
  - name: tnrpwd
    count: 1
#    hostnetwork: true
    containers:
    - name: tnrpwd
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/thargrove/tnrpwd:thargrove-20170329_161129-693e7ee
      command: ["/bin/tnrpWatchdog"]
      args: ["-tokenfile", "/var/secrets/token.txt"]
      ports:
      - containerPort: 64132
      livenessProbe:
        httpGet:
          path: /probe
          port: 64132
      volumeMounts:
        - mountPath: /var/secrets
          name: secretvol
          readOnly: true
    volumes:
    - name: secretvol
      secret:
        secretName: git-token
  loadbalancers:
  - lbname: tnrpwdlb
    function: tnrpwd
    nodeExposed: true
    ports:
      - port: 64132
        targetport: 64132
