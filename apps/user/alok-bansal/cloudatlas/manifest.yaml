apiVersion: v1
system:
  functions:
  - name: cloudatlas-test
    count: 1
    containers:
    - name: cloudatlas-baked
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/alok-bansal/c2c-ca-docker:811a2be
      ports:
      - containerPort: 1636
      - containerPort: 8090
      - containerPort: 7030
      - containerPort: 1389
      - containerPort: 8989
      livenessProbe:
        exec:
          command:
          - /opt/pdm/pdm.customer/bin/is-alive.sh
        initialDelaySeconds: 300
        periodSeconds: 60
      volumeMounts:
      - mountPath: /home/sfdc-atlas
        name: hosthomevol
      - mountPath: /home/sfdc-atlas/logs/servers/ds
        name: pinglogvol
      - mountPath: /log
        name: logvol
      - mountPath: /clientcerts
        name: client-cert
    volumes:
    - name: logvol
      emptyDir: {}
    - name: hosthomevol
      emptyDir: {}
    - name: pinglogvol
      emptyDir: {}
    - name: pdmvol
      emptyDir: {}
    - name: client-cert
      maddogCert:
        type: client

# SLB
  loadbalancers:
  - lbname: ca-service-lb
    function: cloudatlas-test
    slbEnabled: true
    ports:
      - port: 1636
        targetport: 1636
      - port: 8090
        targetport: 8090
      - port: 7030
        targetport: 7030