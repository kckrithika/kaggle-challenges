apiVersion: v1
 
system:
  functions:
  - name: grpc-service
    count: 2
    containers:
    - name: grpc-service
      image: shared0-samcontrol1-1-prd.eng.sfdc.net:5000\\/jbratton-grpc-service:0.0.2
      ports:
      - name: grpc-port
        containerPort: 7010
    - name: sherpa
      image: shared0-samcontrol1-1-prd.eng.sfdc.net:5000/sherpa:joey-4
      args: ["-a", "7080", "-i", "7012", "-o", "7011", "-s", "grpc-service", "-p", "7010"]
      ports:
      - name: admin-port
        containerPort: 7080
      - name: in-port
        containerPort: 7012
      - name: out-port
        containerPort: 7011
      readinessProbe:
        exec:
          command:
            - is-ready.sh 
          initialDelaySeconds: 5 
          periodSeconds: 5
      livenessProbe:
        exec:
          command:
            - is-alive.sh 
          initialDelaySeconds: 10
          periodSeconds: 5
 
  loadbalancers:
  - lbname: grpc-service-lb
    function: grpc-service
    ports:
      - name: admin-port
        port: 7080
        targetport: 7080
      - name: in-port
        port: 7012
        targetport: 7012
