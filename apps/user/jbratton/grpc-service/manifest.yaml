apiVersion: v1
 
system:
  functions:
  - name: grpc-service
    count: 2
    containers:
    - name: grpc-service
      image: shared0-samcontrol1-1-prd.eng.sfdc.net:5000/jbratton-grpc-service:0.0.2
      ports:
      - name: grpc-port
        containerPort: 5000
    - name: sherpa
      image: shared0-samcontrol1-1-prd.eng.sfdc.net:5000/sherpa:joey-1
      args: ["-a", "9999", "-i", "4141", "-o", "4142", "-s", "5000"]
      ports:
      - name: admin-port
        containerPort: 9999
      - name: in-port
        containerPort: 4141
      - name: out-port
        containerPort: 4142
      readinessProbe:
        exec:
          command:
            - is-ready.sh 
          initialDelaySeconds: 5 
          periodSeconds: 5
      livenessProbe:
        exec:
          command:
            - is-alive.sh 
          initialDelaySeconds: 10
          periodSeconds: 5
 
  loadbalancers:
  - lbname: grpc-service-lb
    function: grpc-service
    ports:
      - name: admin-port
        port: 9999
        targetport: 9999
      - name: in-port
        port: 4141
        targetport: 4141
