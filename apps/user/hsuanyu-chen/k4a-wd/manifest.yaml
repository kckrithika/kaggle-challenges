apiVersion: v1

system:
  functions:
  - name: k4a-watchdog-prd
    count: 1
    containers:
    - name: k4a-watchdog
      image: dva/k4a-caiman-watchdog:178-bd80fdec17e2c21732f10003bb08e1a117a1fb7b
      command:
      - "java"
      - "-Duser.home=/tmp"
      - "-jar"
      - "/caiman-watchdog/caiman-watchdog-0.0.15-SNAPSHOT.jar"
      - "-secretsFile"
      - "/caiman-watchdog/classes/samapp.user-hsuanyu-chen.k4a-watchdog-prd.zip"
      - "-certPath"
      - "/clientcert"
      - "-sleepTime"
      - "5"
      - "-datacenter"
      - "PRD"
      - "-hostname"
      - $(NODE_NAME)
      env:
      - name: NODE_NAME
        valueFrom:
          fieldRef:
            fieldPath: spec.nodeName
      livenessProbe:
        exec:
          command: ["ls", "/"]
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 60
      volumeMounts:
      - mountPath: /clientcert
        name: cert
    - name: k4a-watchdog-crd
      image: dva/k4a-caiman-watchdog:178-bd80fdec17e2c21732f10003bb08e1a117a1fb7b
      command:
      - "java"
      - "-Duser.home=/tmp"
      - "-jar"
      - "/caiman-watchdog/caiman-watchdog-0.0.15-SNAPSHOT.jar"
      - "-secretsFile"
      - "/caiman-watchdog/classes/samapp.user-hsuanyu-chen.k4a-watchdog-prd.zip"
      - "-certPath"
      - "/clientcert"
      - "-sleepTime"
      - "5"
      - "-url"
      - "https://sec0-kfora1-2-crd.eng.sfdc.net:8443"
      - "-datacenter"
      - "PRD"
      - "-hostname"
      - $(NODE_NAME)
      env:
      - name: NODE_NAME
        valueFrom:
          fieldRef:
            fieldPath: spec.nodeName
      livenessProbe:
        exec:
          command: ["ls", "/"]
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 60
      volumeMounts:
      - mountPath: /clientcert
        name: cert
    volumes:
    - name: cert
      maddogCert:
        type: client