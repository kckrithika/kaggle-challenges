apiVersion: v1

system:
  notifications:
    email:
      - rakella@salesforce.com
  functions:

    - name: scheduler-demo-ssl
      count: 1
      identity:
        serviceName: scheduler-demo-client
        pod: cs101
      containers:
        - name: crondemo
          image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/rakella/scheduler-demo-client:ssl
          ports:
            - name: http-port
              containerPort: 9090
          command: ["./launcher.sh"]
          args:
            - --scheduler.service.hostname=cs101-cron-lb.scheduler-service.prd-sam.prd.slb.sfdc.net
            - --scheduler.service.port=7012              
          env:
            - name: SFDC_ENVIRONMENT
              value: mesh
          resources:
            limits: { cpu: "1", memory: "1Gi" }
            requests: { cpu: "1", memory: "1Gi" }
          livenessProbe:
            exec:
              command: ["/bin/true"]
            initialDelaySeconds: 10
            timeoutSeconds: 10
            periodSeconds: 60
          readinessProbe:
            exec:
              command: ["/bin/true"]
            initialDelaySeconds: 10
            timeoutSeconds: 10
          volumeMounts:
            - mountPath: /var/log/crondemo
              name: logvol

      volumes:
        - name: logvol
          hostpath:
            path: /var/log/crondemo

  loadbalancers:
  - lbname: cs101-demo-lb
    function: scheduler-demo-ssl
    slbenabled: true
    ports:
      - port: 9090
        targetport: 9090

