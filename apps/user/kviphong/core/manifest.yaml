apiVersion: v1
 
system:
  functions:
  - name: core
    count: 3

    containers:
    - name: core-sam
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/mgainsborough/casam:208.12-1003

      livenessProbe:
        exec:
          command:
           - echo
           - HEALTHY
        initialDelaySeconds: 60
        periodSeconds: 1

      readinessProbe:
        httpGet:
          path: /ready.jsp
          port: 9000
        initialDelaySeconds: 120
        periodSeconds: 1
        failureThreshold: 3
 
      ports:
        - containerPort: 9000

      env:
        - name: PUBLIC_HOST_NAME
          value: shared0-samcompute1-1-prd.eng.sfdc.net
        - name: DEPLOYMENT
          value: B
        - name: PORT
          value: 9000
        - name: NODES
          value: 3
        - name: IP_APP1
          value: 10.225.242.231
        - name: IP_APP2
          value: 10.225.242.30
        - name: IP_ACS1
          value: 10.225.242.124
        - name: IP_ACS2
          value: 10.225.242.193
        - name: IP_DB
          value: 10.225.242.80
        - name: IP_QPID1
          value: 10.225.242.81
        - name: IP_QPID2
          value: 10.225.242.56
        - name: IP_MNDS1
          value: 10.225.242.46
        - name: IP_FFX1
          value: 10.225.242.75
        - name: IP_FFX2
          value: 10.225.242.82
        - name: DB_USER
          value: oracle 
        - name: DB_PASSWORD
          value: oracle
        - name: DB_SID
          value: database

    strategy:
      type: RollingUpdate
      rollingUpdate:
        maxSurge: 200%
        maxUnavailable: 0

  loadbalancers:
  - lbname: coreslb
    function: core
    nodeExposed: true
    ports:
    - port: 9001
      targetport: 9000
