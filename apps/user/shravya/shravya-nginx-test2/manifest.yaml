apiVersion: v1
 
system:
  functions:
  - name: default3
    count: 1
    containers:
    - name: nginxtest1
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/shravya/nginx:unprivileged
      command: ["/bin/bash"]
      args:
      - -c 
      - "dd if=/dev/urandom of=file.txt count=1024 bs=1048576 &&  cp /usr/share/nginx/html/index.html  /usr/share/nginx/html/live.html &&
         cp file.txt /usr/share/nginx/html/index.html && nginx -g 'daemon off;'" 
      ports:
      - containerPort: 8080
      livenessProbe:
        initialDelaySeconds: 600
        httpGet:
          path: /live.html
          port: 8080
 
  loadbalancers:
  - lbname: shrav-nginx-2
    function: default3
    slbenabled: true
    ports:
      - port: 8080
        targetport: 8080
        lbtype: http