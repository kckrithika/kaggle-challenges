apiVersion: v1
system:
  functions:
  - name: default
    count: 1
    containers:
    - name: sip-experiment-manager
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/fhassan/sip-em-sam:fhassan-20190110-1 
      ports:
      - containerPort: 8181
      livenessProbe:
        exec:
          command: ["/bin/true"]
        initialDelaySeconds: 20
      volumeMounts:
      - mountPath: /secrets/
        name: secretvol
        readOnly: true
      - mountPath: /certs
        name: sipapicert
    volumes:
    - name: secretvol
      k4aSecret:
        secretName: super-duper-secret
    - name: sipapicert
      maddogCert:
        type: server
        lbnames:
        - sipemlb
  loadbalancers:
  - lbname: sipemlb
    function: default
    slbenabled: true
    ports:
      - port: 8181
        targetport: 8181
        lbtype: tcp 
      - port: 8081
        targetport: 8181
        lbtype: tcp
        tls: true
        reencrypt: false


