apiVersion: v1
system:
  functions:
  - name: default
    count: 1
    containers:
    - name: sip-experiment-manager
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/fhassan/sip-em-sam:fhassan-20181219-2 
      ports:
      - containerPort: 8181
      livenessProbe:
        exec:
          command: ["/bin/true"]
        initialDelaySeconds: 20
      volumeMounts:
      - mountPath: /secrets/
        name: secretvol
        readOnly: true
      - mountPath: /certs/server
        name: sipapicert
    volumes:
    - name: secretvol
      k4aSecret:
        secretName: super-duper-secret
    - name: sipapicert
      maddogCert:
        type: server
        lbnames:
        - sipemlb
  loadbalancers:
  - lbname: sipemlb
    function: default
    slbenabled: true
    ports:
      - port: 8181
        targetport: 8181
        lbtype: http
      - port: 8080
        targetport: 8181
        lbtype: http
        tls: true
        reencrypt: true
      - port: 8081
        targetport: 8181
        lbtype: http
        tls: true
        reencrypt: false
      - port: 8082
        targetport: 8181
        lbtype: http
        tls: false
        reencrypt: true


