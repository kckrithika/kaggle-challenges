apiVersion: v1

system:
  functions:
  - name: gater-test-cluster-1
    count: 3
    hostnetwork: true
    containers:
    - name: gater1
      # container image/version to run.
      # this is published separately to http://shared0-samcontrol1-1-prd.eng.sfdc.net:5000
      image: gater-test:dmachak-20161107D
      args:
        - start
        - --zookeeper.seedHosts=blitz1-mnds1-1-sfm.ops.sfdc.net:2181
        - --logging.app.dir=/log
        - --java.io.tmpdir=/tmp
        - --aura.production=true
        - --server.port=9090
        - --external.config.dir=/opt/gater/build
        - --synctask.enabled=true
        - --synctask.artifact=gate-definitions-blitz
      volumeMounts:
      - mountPath: /log
        name: logvol

      # expose gater outside the container
      ports:
      - containerPort: 9522
      - containerPort: 9523 
      - containerPort: 9090
      - containerPort: 15372

    volumes:
    - name: logvol
      hostPath:
        path: /var/log/gater