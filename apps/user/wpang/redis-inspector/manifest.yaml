apiVersion: v1

system:
  functions:
  - name: redis-inspector
    count: 1
    containers:
    - name: redis-inspector
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/wpang/redis-inspector:080818
      env:
      - name: RINSP_REDIS_HOST
        value: $(REDISLB_SERVICE_HOST)
      - name: RINSP_REDIS_PORT
        value: $(REDISLB_SERVICE_PORT)
      - name: RINSP_COMMANDS_INFO_INTERVAL
        value: 30s
      - name: RINSP_COMMANDS_COMMANDSTATS_INTERVAL
        value: 30s
      - name: RINSP_COMMANDS_KEYSPACE_INTERVAL
        value: 30s
      - name: RINSP_COMMANDS_SLOWLOG_INTERVAL
        value: 30s
      - name: RINSP_AJNA_FLUSHINTERVAL
        value: 60s
      command: ["/bin/sh", "-c"]
      args: ["
      export RINSP_AJNA_FUNNEL_HOST=${SFDC_METRICS_SERVICE_HOST} ;
      export RINSP_AJNA_FUNNEL_PORT=${SFDC_METRICS_SERVICE_PORT} ;
      export RINSP_AJNA_DATACENTER=${KINGDOM} ;
      export RINSP_AJNA_DEVICE=${HOSTNAME} ;
      ./redis-inspector
      "]
    - name: redis
      count: 1
      containers:
      - name: redis
      image: tnrp/csc-health/redis-auth:4.0.8-0000008-24e58629
      ports:
      - containerPort:6379

    loadbalancers:
    - lbnamei: redislb
      function: redis
      nodeExposed: true
      ports:
      - port: 6379
        targetport: 6379


