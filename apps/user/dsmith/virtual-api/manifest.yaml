apiVersion: v1
system:
  functions:
  - name: pseudo-kubeapi
    count: 5
    progressDeadlineSeconds: 120
    containers:
    - name: virtual-api
      command:
        - /sam/virtual-api
        - --sql-db-host=mysql.csc-sam.prd-sam.prd.slb.sfdc.net
        - --sql-db-port=3306
        - --sql-db-name=duncan
        - --sql-db-pass=pass
        - --sql-db-user=root
        - --sql-db-resources-table=k8s_resource_sqls
        - --v=4
        - --alsologtostderr
        - --insecure-port=7002
        - --passthrough-api-server=shared0-samkubeapi1-1-prd.eng.sfdc.net:40000
        - --passthrough-all-cluster=prd-sam
        - --secret-passthrough-namespace=kube-system
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/d.smith/hypersam:latest
      ports:
      - containerPort: 7002
      livenessProbe:
        httpGet:
          path: /healthz
          port: 7002
      env:
      - name: DUMMY_VAR
        value: here
  loadbalancers:
  - lbname: pseudo-kubeapi
    function: pseudo-kubeapi
    slbEnabled: true
    ports:
      - port: 40001
        targetport: 7002
