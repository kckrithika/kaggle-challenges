apiVersion: v1

system:
    notifications:
        email:
        - afalko@salesforce.com

    functions:
    - name: zipkin-es-spark
      count: 1
      strategy:
          type: RollingUpdate
          rollingUpdate:
              maxSurge: 0
              maxUnavailable: 1
      containers:
      - name: zipkin-es-spark
        image: docker-dva-rc/dva/zipkin-dependencies-spark-standalone:2
        # See https://github.com/openzipkin/zipkin-dependencies for available ENV options
        env:
        - name: ES_HOSTS
          value: 'es-rest:9200'
        - name: ES_NODES_WAN_ONLY
          value: 'true'
        livenessProbe:
            exec:
                # TODO: Check if process is running?
                command: 
                - /bin/true
            initialDelaySeconds: 5
            periodSeconds: 5        
        #- mountPath: /certs
        #  name: certs
        #- mountPath: /secrets
        #  name: es-pass
        #  readOnly: true
