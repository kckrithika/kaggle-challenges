apiVersion: v1
system:
  notifications:
    email:
      - awaterman@salesforce.com
  functions:
  - name: mta
    count: 3 
    terminationGracePeriodSeconds: 35
    containers:
    - name: mta
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-dva-rc/dva/sfdc-mta:latest
      ports:
      - name: smtp 
        containerPort: 25
      env:
      - name: SFDC_ENVIRONMENT
        value: prd
      - name: SCONE_SERVICE_NAME
        value: mta 
      - name: SFDC_POD
        value: awaterman
      livenessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - echo ^C | nc 127.0.0.1 25
          initialDelaySeconds: 20 
          periodSeconds: 2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - echo ^C | nc 127.0.0.1 25
          initialDelaySeconds: 20 
          periodSeconds: 2
  loadbalancers:
  - lbname: emailinfra-mta-awaterman-lb
    function: mta
    slbEnabled: true
    ports:
    - lbtype: tcp
      port: 25
      targetport: 25
    - lbtype: tcp
      port: 25
      targetport: 25
