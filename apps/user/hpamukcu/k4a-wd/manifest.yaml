apiVersion: v1

system:
  functions:
  - name: k4a-watchdog-prd
    count: 1
    containers:
    - name: k4a-watchdog
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/hpamukcu/caiman-watchdog/k4a-20191022-2:latest
      command:
      - "java"
      - "-Duser.home=/tmp"
      - "-jar"
      - "/caiman-watchdog/caiman-watchdog-0.0.15-SNAPSHOT.jar"
      - "-secretsFile"
      - "/caiman-watchdog/classes/samapp.user-unknown.k4a-watchdog-prd.zip"
      - "-certPath"
      - "/clientcert"
      - "-sleepTime"
      - "5"
      - "-datacenter"
      - "PRD"
      - "-hostname"
      - $(NODE_NAME)
      env:
      - name: NODE_NAME
        valueFrom:
          fieldRef:
            fieldPath: spec.nodeName
      livenessProbe:
        exec:
          command: ["ls", "/"]
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 60
      volumeMounts:
      - mountPath: /clientcert
        name: cert
    volumes:
      - name: cert
        maddogCert:
          type: client
