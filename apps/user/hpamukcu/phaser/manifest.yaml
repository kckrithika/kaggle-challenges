apiVersion: v1

system:
  functions:
    - name: deployerbot
      count: 1
      containers:
        - name: phaser
          image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/hpamukcu/deployerbot:hpamukcu-202002140939
          env:
            - name: GO_PIPELINE_LABEL
              value: 1
            - name: NODE_NAME
              valueFrom:
                fieldRef:
                  fieldPath: spec.nodeName
          command: ["/moe/deployerbot/phaser"]
          args:
            - "-gheTokenPath=/secrets/ghe_pat"
            - "-pgpkeypath=/gpgsecrets/signing-key.asc"
          volumeMounts:
            - mountPath: /secrets
              name: phaser-ghe-pat
              readOnly: true
            - mountPath: /gpgsecrets
              name: phaser-signing-key-asc
              readOnly: true
          livenessProbe:
            exec:
              command: ["ls", "/"]
            failureThreshold: 3
            initialDelaySeconds: 5
            periodSeconds: 60
      volumes:
        - name: phaser-ghe-pat
          k4aSecret:
            secretName: phaser-ghe-pat
        - name: phaser-signing-key-asc
          k4aSecret:
            secretName: phaser-signing-key-asc