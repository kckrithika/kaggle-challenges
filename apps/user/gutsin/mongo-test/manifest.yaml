apiVersion: v1

system:
  functions:
  - name: mongo-rs
    count: 3
    containers:
      - name: mongo
        image: shared0-samcontrol1-1-prd.eng.sfdc.net:5000/gutsin-mongo:1
        command:
          - mongod
          - "--replSet"
          - rs0
          - "--smallfiles"
          - "--noprealloc"
        ports:
          - containerPort: 27017
      - name: mongo-sidecar
        image: shared0-samcontrol1-1-prd.eng.sfdc.net:5000/gutsin-mongo:sidecar
        env:
          - name: MONGO_SIDECAR_POD_LABELS
            value: "role=mongo,environment=test"

  loadbalancers:
  - lbname: mongo-lb
    function: mongo-rs
    ports:
      - port: 27017
        targetport: 27017
