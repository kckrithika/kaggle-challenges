apiVersion: v1
system:
  functions:
  - name: default
    count: 1
    volumes:
    - name: capadd-client-cert
      maddogCert:
        type: client
    - name: capadd-server-cert
      maddogCert:
        type: server
    - name: secretvol
        k4aSecret:
          secretName: gus
          items:
            - key: gususername
              path: gussecret/username
              mode: 511
            - key: guspassword
              path: gussecret/password
              mode: 511
    - name: oauthsecretvol
        k4aSecret:
          secretName: oauthclient
          items:
            - key: oauthclientkey
              path: oauth/oauthkey
              mode: 511
            - key: oauthclientsecret
              path: oauth/oauthsecret
              mode: 511
    containers:
    - name: capadd
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/qwang/capadd:certtest-20200117-1
      volumeMounts:
        - name: capadd-client-cert
          mountPath: /clientcert
        - name: capadd-server-cert
          mountPath: /servercert
        - name: secretvol
          mountPath: /secrets
          readOnly: true
        - name: oauthsecretvol
            mountPath: /oauthsecrets
            readOnly: true
      ports:
      - containerPort: 8787
      livenessProbe:
        httpGet:
          path: /capadd
          port: 8787

