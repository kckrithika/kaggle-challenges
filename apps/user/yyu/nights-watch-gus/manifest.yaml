apiVersion: v1
system:
  functions:
    - name: default
      count: 1
      env:
      - name: CERTS_HOSTCERT
        value: /certs/client/certificates/client.pem
      - name: CERTS_HOSTKEY
        value: /certs/client/keys/client-key.pem
      - name: CERTS_CACERT
        value: /certs/ca.pem
      volumes:
      - name: cert
        maddogCert:
          type: client
      containers:
      - name: nights-watch-gus
        image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/dataprotection/nights-watch-gus:20171120
        volumeMounts:
        - name: cert
          mountPath: /certs
        ports:
        - containerPort: 8091
        livenessProbe:
          initialDelaySeconds: 60
          periodSeconds: 5
          exec:
            command:
            - ls
            - /
          #httpGet:
          #  path: /
          #  port: 8091
  loadbalancers:
  - lbname: nights-watch-gus-lb
    function: default
    nodeExposed: true
    slbEnabled: true
    ports:
      - port: 8091
        targetport: 8091
