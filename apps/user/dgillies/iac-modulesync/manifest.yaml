---
apiVersion: v1
system:
  functions:
    - name: iac-modulesync
      count: 1
      volumes:
        - name: secretvol
          k4aSecret:
            secretName: iac-modulesync
      containers:
        - name: iac-modulesync
          image: ops0-artifactrepo2-0-prd.data.sfdc.net/dva/iac_centos7_webhook:7
          command:
            - /opt/webhook/bin/run.sh
          ports:
            - containerPort: 9000
          livenessProbe:
            httpGet:
              path: /hooks/status
              port: 9000
            initialDelaySeconds: 30
            periodSeconds: 60
          volumeMounts:
            - mountPath: /secrets/
              name: secretvol
              readOnly: true

  loadbalancers:
    - lbname: iac-modulesync
      function: iac-modulesync
      slbenabled: true
      ports:
        - port: 443
          targetport: 9000
          lbtype: http
          tls: true
