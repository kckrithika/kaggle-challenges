apiVersion: v1
system:
  functions:
    - name: mgmtserver-api
      count: 1
      type: stateful-set
      containers:
        - name: mgmtserver-api
          image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/anudeept/mgmtapi:1.0
          command:
          - /bin/bash
          - -c
          args:
          - tail -f /dev/null
          livenessProbe:
            exec:
              command: ["ps -ef"]
            initialDelaySeconds: 600000
            timeoutSeconds: 10000000
          volumeMounts:
            - name: tls-client-cert
              mountPath: /client-certs
            - name: tls-server-cert
              mountPath: /server-certs
          ports:
          - containerPort: 5004
          resources:
            requests:
              cpu: 2
              memory: 3Gi
            limits:
              cpu: 3
              memory: 4Gi
          env:
            - name: SHELL
              value: "/bin/bash"
            - name: UP_STRING
              value: "UI API Server Blocking."
            - name: SERVERNAME
              value: 127.0.0.1
            - name: ENV_MODE
              value: "production"
            - name: NODE_ENV
              value: "production"
            - name: INSTALLATION_TYPE
              value: CLUSTER
            - name: MYSQL_SERVER
              value: 10.254.213.9
            - name: MYSQL_USER
              value: "ddnuser"
            - name: MYSQL_ROOT_PASSWORD
              value: "rootPassword"
            - name: MYSQL_ROOT
              value: "root"
            - name: MYSQL_DATABASE
              value: "ddnprod"
            - name: MYSQL_PASSWORD
              value: "ddnpassword"
            - name: JWT_SECRET_KEY
              value: "geocloudDDNApiPlatformKey"
      lbname: mgmtserver-api-lb
      volumes:
      - name: tls-client-cert
        maddogCert:
          type: client
      - name: tls-server-cert
        maddogCert:
          type: server
