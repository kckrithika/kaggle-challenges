apiVersion: v1

system:
  functions:
  - name: adhoot-stateful-fn
    type: stateful-set
    count: 1
    containers:
    - name: statefulhello
      image: tnrp/sam/hypersam:sam-0000701-487f2675
      command: ["/sam/sam-test-app"]
      args: ["-estate", "$(ESTATE)", "-kingdom", "$(KINGDOM)"]
      ports:
      - containerPort: 8000
        name: testportname
      volumeMounts:
      - name: statevolume
        mountPath: /test/state
      - name: server-cert
        mountPath: /cert
      livenessProbe:
        httpGet:
          path: /
          port: 8000
    lbname: statefulhellolb
    volumeClaimTemplates:
      - name: statevolume
        storageClassName: standard
        storageSizeRequest: 3Gi
    volumes:
      - name: server-cert
        maddogCert:
          type: server
