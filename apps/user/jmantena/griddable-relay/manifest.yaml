apiVersion: v1
system:
   functions:
   - name: acds-relay
     count: 1
     type: stateful-set
     containers:
     - name: acds-relay-cont
       image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/mmanthena/griddable-full:v0.0.1
       ports:
          - containerPort: 10234
       command:
       - /bin/bash
       - -c
       - /acds/bin/start-acds.sh
       livenessProbe:
         exec:
           command:
           - "/acds/bin/acdsOk.sh"
         initialDelaySeconds: 10
         timeoutSeconds: 5
       volumeMounts:
         - mountPath: /acds/acds-secrets/
           name: acds-secrets-vol
           readOnly: true
         - name: tls-client-cert
           mountPath: /client-certs
         - name: tls-server-cert
           mountPath: /server-certs
       resources:
         requests:
           cpu: 2
           memory: 4Gi
         limits:
           cpu: 3
           memory: 6Gi
       env:
       - name : LOGGING_JSON_STDOUT_LEVEL
         value: all
       - name : LOGGING_STDERR_LEVEL
         value: all
       - name : ACDS_POLICY
         value: "io.griddable.policy:{\"ACDS_TEST\":{}}"
       - name : ACDS_DB_CONFIG
         value: "{
    \"additionalParams\" : {
        \"useServiceName\" : \"AUTO\",
        \"useStatementBatching\" : false
    },
    \"host\" : \"10.225.242.101\",
    \"id\" : \"srcdb\",
    \"instanceName\" : \"DATABASE\",
    \"password\" : \"basic:xRdN9n9+Yto2hHDW/sldaA==\",
    \"port\" : 1521,
    \"type\" : \"oracle\",
    \"user\" : \"ACDS_TEST\"}"
       - name : TENANT_ADMIN_NAME
         value: "admin@local"
       - name : TENANT_ADMIN_PASSWORD
         value: "synchronize"
       - name : GRID_NAME
         value: "Grid_02"
       - name : GRID_CONNECTION_NAME
         value: "DS_CONN_DD_2"
       - name : DD_NAME
         value: "Target_12"
       - name : DS_NAME
         value: "Source_12"
       - name : DB_NAME
         value: "ddnprod"
       - name : GRID_CONNECTION_ID
         value: "DS_CONN_DD_1"
       - name : PATH
         value: "/opt/tools/Linux/jdk/openjdk1.8.0_172_x64/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:$PATH"
       - name : JAVA_HOME
         value: "/opt/tools/Linux/jdk/openjdk1.8.0_172_x64"
       - name : LANG
         value: "en_US.UTF-8"
       - name : SERVICE_USER_EMAIL
         value: "acds_admin@local"
       - name : TOKEN_SECRET
         value: "jJ5mPbFutWIzGIGvehio1onUctIv5yd3"
       - name : SERVICE_USER_NAME
         value: "acds_admin"
       - name : SERVICE_USER_PASSWORD
         value: "synchronize"
       - name : ACDS_APISERVER_HOST
         value: "acds-mgmt-api-lb.user-athatipalli.prd-sam.prd.slb.sfdc.net"
       - name : ACDS_APISERVER_PORT
         value: "5004"
       - name : ACDS_APISERVER_HTTPS
         value: "false"
       - name : SECRETS_FOLDER_NAME
         value: "/acds/acds-secrets/"
       - name : RELAY_MEMORY_LIMIT
         value: "1700m"
       - name : ACDS_RELAY_EVENT_BUFFER_SIZE
         value: "50m"
       - name : CONSUMER_MEMORY_LIMIT
         value: "900m"
       - name : ACDS_CONSUMER_EVENT_BUFFER_SIZE
         value: "20m"
       - name : CATCHUP_MEMORY_LIMIT
         value: "900m"
       - name : ACDS_CHS_EVENT_BUFFER_SIZE
         value: "20m"
       - name : ACDS_AUTO_CBC_ENABLED
         value: "true"
       - name : ACDS_START_RELAY
         value: "yes"
       - name : ACDS_START_CLIENT
         value: "no"
       - name : DUMMY_VARIABLE
         value: "DUMMY_VARIABLE_5"
     volumes:
     - name: tls-client-cert
       maddogCert:
         type: client
     - name: tls-server-cert
       maddogCert:
         type: server
     - name: acds-secrets-vol
       k4aSecret:
         secretName: acds-secrets
     lbname: acds-relay-stateful-lb    
   loadbalancers:
   - lbname: acds-relay-lb
     function: acds-relay
     slbEnabled: true
     ports:
       - port: 10234
         targetport: 10234