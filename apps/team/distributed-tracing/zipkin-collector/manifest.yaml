apiVersion: v1

system:
  notifications:
    email:
      - distributedtracing@salesforce.com
  functions:
  - name: zipkin-collector
    count: 1
    strategy:
      type: Recreate
    volumes:
    - name: client-certs
      maddogCert:
        type: client
    containers:
    - name: zipkin-collector
      image: docker-dva-rc/dva/zipkin-collector:6
      ports: 
      - name: http
        containerPort: 8080
      - name: https
        containerPort: 8443
      env:
      - name: ZIPKIN_COLLECTOR_HOST
        value: zipkin-collector
      volumeMounts:
      - mountPath: /etc/pki_service/zipkin-collector
        name: client-certs
      livenessProbe:
        exec:
          # TODO: Check if process is running?
          command:
          - /bin/true
