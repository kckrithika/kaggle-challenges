apiVersion: v1

system:
  notifications:
    email:
      - distributedtracing@salesforce.com
  functions:
  - name: zipkin-alpha
    count: 1
    strategy:
      type: RollingUpdate
      rollingUpdate:
        maxSurge: 0
        maxUnavailable: 1
    containers:
    - name: zipkin-alpha
      image: docker-dva-rc/dva/zipkin-server:11
      ports:
      - name: zipkin
        containerPort: 7022
      livenessProbe:
        httpGet:
          path: /health
          port: 7022
        initialDelaySeconds: 120

  loadbalancers:
  - lbname: zipkin-alpha
    function: zipkin-alpha
    nodeExposed: true
    slbEnabled: true
    ports:
      - port: 19222
        targetport: 7022
        lbtype: http
