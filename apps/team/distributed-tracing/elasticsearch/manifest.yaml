system:
  notifications:
    email:
      - distributedtracing@salesforce.com
  functions: 
  - name: zipkin-es-curator
    count: 1
    strategy:
        type: RollingUpdate
        rollingUpdate:
            maxSurge: 0
            maxUnavailable: 1
    containers:
    - name: zipkin-es-curator
      image: docker-dva-rc/dva/zipkin-es-curator:4
      env:
      - name: ES_HOSTS
        value: 'shared0-samminionzipkin2-2-prd.eng.sfdc.net:9200,shared0-samminionzipkin2-4-prd.eng.sfdc.net:9200,shared0-samminionzipkin2-11-prd.eng.sfdc.net:9200'
      - name: DELETE_AFTER_DAYS
        value: 7
      livenessProbe:
          exec:
              # TODO: Check if process is running?
              command:
              - /bin/true
          initialDelaySeconds: 5
          periodSeconds: 5

  - name: zipkin-es-spark
    count: 1
    strategy:
        type: RollingUpdate
        rollingUpdate:
            maxSurge: 0
            maxUnavailable: 1
    containers:
    - name: zipkin-es-spark
      image: docker-dva-rc/dva/zipkin-dependencies-spark-standalone:13
      # See https://github.com/openzipkin/zipkin-dependencies for available ENV options
      env:
      - name: ES_HOSTS
        value: 'shared0-samminionzipkin2-2-prd.eng.sfdc.net:9200,shared0-samminionzipkin2-4-prd.eng.sfdc.net:9200,shared0-samminionzipkin2-11-prd.eng.sfdc.net:9200'
      # TODO: This might be an upstream bug; either way we should enable auth here eventually
      - name: SPARK_USER
        value: ''
      - name: ES_NODES_WAN_ONLY
        value: 'true'
      livenessProbe:
          exec:
              # TODO: Check if process is running?
              command:
              - /bin/true
          initialDelaySeconds: 5
          periodSeconds: 5
      #- mountPath: /certs
      #  name: certs
      #- mountPath: /secrets
      #  name: es-pass
      #  readOnly: true
