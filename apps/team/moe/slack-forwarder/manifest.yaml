apiVersion: v1

system:
  functions:
  - name: slack-forwarder
    count: 2
    containers:
    - name: slack-forwarder
      image: dva/moe/reverse-proxy:2507-8eb6be5e433b0dd8b0eb8f69b580444872ec97b2
      command: ["/moe/reverse-proxy"]
      args:
      - "-reverse-proxy.publicProxyURL=http://public0-proxy1-0-prd.data.sfdc.net:8080"
      - "-reverse-proxy.targetURL=https://hooks.slack.com/services/"
      - "-reverse-proxy.listenPort=8080"
      ports:
      - containerPort: 8080
      livenessProbe:
        httpGet:
          path: /healthz
          port: 8080
  loadbalancers:
  - lbname: slack-forwarder
    function: slack-forwarder
    slbenabled: true
    ports:
      - port: 443
        targetport: 8080
        lbtype: http
        tls: true
