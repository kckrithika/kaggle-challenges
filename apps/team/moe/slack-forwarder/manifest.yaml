apiVersion: v1

system:
  functions:
  - name: slack-forwarder
    count: 2
    containers:
    - name: slack-forwarder
      image: dva/moe/reverse-proxy:2077-b9a67a61e7ec6ef1fdc95e3fe46496c11170cfe8
      command: ["/moe/reverse-proxy"]
      args:
      - "-publicProxyURL=http://public0-proxy1-0-prd.data.sfdc.net:8080"
      - "-targetURL=https://hooks.slack.com/services/"
      - "-listenPort=8080"
      ports:
      - containerPort: 8080
      livenessProbe:
        httpGet:
          path: /healthz
          port: 8080
  loadbalancers:
  - lbname: slack-forwarder
    function: slack-forwarder
    slbenabled: true
    ports:
      - port: 443
        targetport: 8080
        lbtype: http
        tls: true