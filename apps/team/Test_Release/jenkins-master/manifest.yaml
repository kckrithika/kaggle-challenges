apiVersion: v1

system:
  functions:
  - name: jenkins-master
    count: 1
    containers:
    - name: jenkins-master
      image: tnrp/jenkins-swarm-master:2.32.3
      ports:
      - name: webui
        containerPort: 8080
      - name: agent
        containerPort: 50000
      resources:
        limits: { cpu: "10", memory: "20Gi" }
        requests: { cpu: "10", memory: "20Gi" }
      volumeMounts:
        - mountPath: /var/jenkins_home
          name: jenkins-data
      livenessProbe:
        httpGet:
          path: /login
          port: 8080
        initialDelaySeconds: 120
    volumes:
      - name: jenkins-data
        emptyDir: {}
  loadbalancers:
  - lbname: jenkinstnrpmasterlb
    function: jenkins-master
    nodeExposed: true
    ports:
    - port: 8080
      targetport: 8080
    - port: 50000
      targetport: 50000
