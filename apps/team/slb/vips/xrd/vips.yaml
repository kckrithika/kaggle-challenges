## ##
## This VIP definition creates a VIP named ssh-to-somewhere-slb-xrd.slb.sfdc.net
## This VIP listens on port 22 and forwards packets port 22 on one of the specified backends. 
## Traffic is only sent to backend servers if they satisfy the specified health probe.
## This contrived allows for a user to ssh to a randomly selected member of backend pool.

# lbname specifies the unqualified name of the VIP. In XRD, for example,
# the FQDN would be lbname-team-xrd.slb.sfdc.net, where 'team' represents
# your team's namespace under sam/manifests/app/team/
- lbname: ssh-to-somewhere
  iptype: private_reserved
# servers specifies the pool members for the VIP
  servers:
   - shared0-slbminion1-1-xrd.eng.sfdc.net
   - shared0-slbminion1-2-xrd.eng.sfdc.net
   - shared0-slbminion1-3-xrd.eng.sfdc.net
  # port specifies the port upon which the VIP listens. targetport specifies
  # the port on the backend pool member that actually receives the traffic.
  # Packets sent to lbname:port will be sent to server:targetport
  # lbtype specifies the style of load balancing. For L7 functionality (default
  # for an http VIP), specify a value of http. For L4 passthrough, specify tcp.
  ports:
   - port: 22
     targetport: 22
     lbtype: tcp
# Note the healthport, healthpath, and healthprotocol. Each backend has an http endpoint listening on healthport
# and returns 200 OK on the specified healthpath if the backend is elibible to receive traffic.
     healthport: 12087
     healthpath: "/liveness-probe"
     healthprotocol: "http"

## ##
## This VIP definition creates a VIP named check-slb-xrd.slb.sfdc.net
## This VIP listens on port 80 and forwards packets port 12087 on one of the specified backends. 
## Traffic is only sent to backend servers if they satisfy the specified health probe.
## This contrived produces a health-checked HTTP VIP that demonstrates different listening and forwarding
## ports.

# lbname specifies the unqualified name of the VIP. In XRD, for example,
# the name would be lbname-team-xrd.slb.sfdc.net, where 'team' represents
# your team namespace under sam/manifests/app/team/
- lbname: check
  iptype: private_reserved
# servers specifies the pool members for the VIP
  servers:
   - shared0-slbminion1-1-xrd.eng.sfdc.net
   - shared0-slbminion1-2-xrd.eng.sfdc.net
   - shared0-slbminion1-3-xrd.eng.sfdc.net
  # port specifies the port upon which the VIP listens. targetport specifies
  # the port on the backend pool member that actually receives the traffic.
  # Packets sent to lbname:port will be sent to server:targetport
  # lbtype specifies the style of load balancing. For L7 functionality (default
  # for an http VIP), specify a value of http. For L4 passthrough, specify tcp.
  ports:
   - port: 80
     targetport: 12087
     lbtype: http
# Note the healthport and healthpath. Each backend has an http endpoint listening on healthport
# and returns 200 OK on the specified healthpath if the backend is elibible to receive traffic.
     healthport: 12087
     healthpath: "/liveness-probe"
     healthprotocol: "http"