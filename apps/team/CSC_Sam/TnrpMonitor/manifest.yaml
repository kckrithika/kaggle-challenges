apiVersion: v1

system:
  notifications:
    email:
      - sam@salesforce.com
  functions:
  - name: tnrpwd
    count: 1
    containers:
    - name: tnrpwd
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/thargrove/tnrpwd:thargrove-20180226_172116-ea49ea3
      command: ["/bin/tnrpWatchdog"]
      args: ["-tokenfile", "/var/secrets/git/token.txt", "--alsologtostderr"]
      ports:
      - containerPort: 64132
      livenessProbe:
        httpGet:
          path: /probe
          port: 64132
      volumeMounts:
        - mountPath: /var/secrets/git
          name: gitvol
          readOnly: true
    volumes:
    - name: gitvol
      k4aSecret:
        secretName: git-token
  loadbalancers:
  - lbname: tnrpwdlb
    function: tnrpwd
    slbEnabled: true
    ports:
      - port: 64132
        targetport: 64132
