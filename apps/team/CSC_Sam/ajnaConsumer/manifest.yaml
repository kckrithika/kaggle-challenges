apiVersion: v1

system:
  email:
    - a.mitra@salesforce.com
  functions:
  - name: ajnaconsumer
    count: 1
    containers:
    - name: ajnaconsumer
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/hari.udhayakumar/hypersam:20171215_030949.045613dd.dirty.hariudhayak-ltm
      command:
        - /sam/ajnaconsumer
        - -v=3
        - -caFile="/data/certs/ca.crt"
        - -kafkaConsumerEndpoint="ajna0-brokeragg1-0-prd.data.sfdc.net:9093"
        - -kafkaTopics=[]string{"sfdc.prod.sam__prd.ajna_local__opevents"}
        - -databaseHostname="watchdog-mysql.csc-sam.prd-sam.prd.slb.sfdc.net"
        - -databasePasswordFile="/secrets/mysql_watchdog-password"
        - -failedReportsDatabaseName="mysql_watchdog"
        - -allReportsDatabaseName="mysql_watchdog"

      volumeMounts:
      - name: myclientcert
        mountPath: /clientcert
      - mountPath: /secrets
        name: watchdog-mysqlsecret
        readOnly: true

      volumes:
          - name: myclientcert
            maddogCert:
              type: client
          - name: watchdog-mysqlsecret
            k4aSecret:
              secretName: watchdogmysql

      livenessProbe:
        exec:
          command:
          - ls
        initialDelaySeconds: 5
        periodSeconds: 5