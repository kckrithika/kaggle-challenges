apiVersion: v1

system:
  notifications:
    email:
      - sam@salesforce.com
  functions:
  - name: samtestfnwithmaddogmulticerthostnetwork
    hostnetwork: true
    count: 2
    progressDeadlineSeconds: 120
    containers:
    - name: samtestapp
      image: tnrp/sam/hypersam:sam-0001905-ea177527
      command: ["/sam/sam-test-app"]
      args: ["-estate", "$(ESTATE)", "-kingdom", "$(KINGDOM)", "-port", "12000", "-tlsport", "12001"]
      env:
        - name: El337
          value: "20100111011"
      ports:
      - containerPort: 12000
      - containerPort: 12001
      livenessProbe:
        httpGet:
          path: /
          port: 12000
      volumeMounts:
      - mountPath: /log
        name: logvol
      - mountPath: /tmp
        name: amagicvolumethatvanishes
      - mountPath: /certs
        name: certs
      - mountPath: /clientcerts
        name: clientcerts
    volumes:
    - name: logvol
      hostPath:
        path: /home/caas/logs/apps
    - name: amagicvolumethatvanishes
      emptyDir: {}
    - name: certs
      maddogCert:
        type: server
    - name: clientcerts
      maddogCert:
        type: client
  - name: samtestwdwithmaddogmultihostnetwork
    count: 1
    containers:
    - name: samtestwdwithmaddog
      image: tnrp/sam/hypersam:sam-0000701-487f2675
      command: ["/sam/service-wd"]
      args: ["-service=lbappwithcert"]
  loadbalancers:
  - lbname: lbappwithmulticerthostnetwork
    function: samtestfnwithmaddogmulticerthostnetwork
    ports:
      - port: 19002
        targetport: 12000
