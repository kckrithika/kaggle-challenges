apiVersion: v1
system:
  functions:
  - name: sam-deployment-portal
    count: 2
    containers:
    - name: sam-deployment-portal
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/xiao.zhou/sam-deployment-portal-v2:20190419_114124.86f3a7444.dirty.xiaozhou-ltm2
      command:
      - "/sam/sam-deployment-portal-v2"
      - --port=64123
      - --db-hostname=mysql-inmem-service.sam-system.prd-samtwo.prd.slb.sfdc.net
      - --db-username=sdpv2
      - --db-password-file=/volumes/sql-dbpass/sdpv2
      - --db-name=sam_kube_resource
      - --v=4
      - --alsologtostderr
      #- --web-banner-text=
      #- --web-banner-link=
      #- --web-banner-link-text=
      ports:
      - containerPort: 64123
      volumeMounts:
       - mountPath: /volumes/sql-dbpass
         name: mysql
         readOnly: true
      livenessProbe:
        httpGet:
          path: /healthz
          port: 64123
      readinessProbe:
        httpGet:
          path: /healthz
          port: 64123
    volumes:
    - name: mysql
      secret:
        secretName: mysql-passwords
  loadbalancers:
  - lbname: sdp2
    function: sam-deployment-portal
    slbenabled: true
    ports:
      - port: 80
        targetport: 64123
        lbtype: tcp