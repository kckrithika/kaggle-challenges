apiVersion: v1
system:
  functions:
    - name: sam-gcp-test-func-k4a
      count: 2
      containers:
        - name: samhello
          image: gcr.io/gsf-core-devmvp-sam2/jy/samapptest:helloworld
          ports:
            - containerPort: 7965
          livenessProbe:
            httpGet:
              path: /
              port: 9090
          volumeMounts:
            - mountPath: /log
              name: logvol
            - mountPath: /tmp
              name: amagicvolumethatvanishes
            - mountPath: /secrets/
              name: secretvol
              readOnly: true
      volumes:
        - name: logvol
          hostPath:
            path: /home/caas/logs/apps
        - name: amagicvolumethatvanishes
          emptyDir: {}
        - name: secretvol
          k4aSecret:
            secretName: watchdogsecret
  loadbalancers:
    - lbname: samtestsecretlb
      nodeExposed: true
      function: sam-gcp-test-func-k4a
      ports:
        - port: 8348
          targetport: 7965