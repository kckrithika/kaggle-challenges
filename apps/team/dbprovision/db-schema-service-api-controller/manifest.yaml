apiVersion: v1

system:
  functions:
  - name: db-schema-service-api-controller
    count: 2
    containers:
    - name: db-schema-service-api-controller
      image: gcr.io/gsf-mgmt-devmvp-spinnaker/dva/db-schema-service-api-controller:latest
      command: ["java -jar -Dspring.profiles.active=gcp-dev controller/build/libs/controller.jar"]
      env:
        - name: VAULT_TOKEN
          value: "/secrets/dbprovision-vaulttoken"
      ports:
      - containerPort: 11443
      livenessProbe:
        httpGet:
          path: /
          port: 11443
      volumeMounts:
        - mountPath: /secrets/
          name: dbprovision-vaulttoken
          readOnly: true
  volumes:
    - name: dbprovision-vaulttoken
      k4aSecret:
        secretName: dbprovision-vaulttoken
