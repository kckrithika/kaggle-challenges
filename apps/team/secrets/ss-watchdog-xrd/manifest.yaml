apiVersion: v1

system:
  functions:
  - name: secretservice-watchdog
    count: 1
    containers:
    - name: secretservice-watchdog
      # TODO : Switch this back to the short form (dva/secretservice-watchdog:33-b8849b0b48b4edc65f4bc13569a8193c8f6a78dc)
      # TODO : once the XRD artifactory issues are resolved
      image: ops0-artifactrepo1-0-xrd.data.sfdc.net/docker-dva-rc/dva/secretservice-watchdog:42-84452184e6a7ba790b88aed0cef1ae110d15e451
      command: ["/secretservice/secretservice-watchdog"]
      args:
      - "-ssEndpoint=secretservice-xrd.data.sfdc.net"
      - "-wdKingdom=XRD"
      - "-metricsEndpoint=ajna0-funnel1-0-xrd.data.sfdc.net:80"
      - "-vaultName=ss-canary-vault"
      - "-role=sam.secrets.secretservice-watchdog"
      - "-logtostderr=true"
      livenessProbe:
        exec:
          command: ["ls", "/"]
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 60
      volumeMounts:
      - mountPath: /clientcert
        name: cert
    volumes:
    - name: cert
      maddogCert:
        type: client
  - name: secretservice-watchdog-crz-from-xrd
    count: 1
    containers:
    - name: secretservice-watchdog-crz-from-xrd
      image: ops0-artifactrepo1-0-xrd.data.sfdc.net/docker-dva-rc/dva/secretservice-watchdog:42-84452184e6a7ba790b88aed0cef1ae110d15e451
      command: ["/secretservice/secretservice-watchdog"]
      args:
      - "-wdKingdom=XRD"
      - "-metricsEndpoint=ajna0-funnel1-0-xrd.data.sfdc.net:80"
      - "-vaultName=ss-canary-vault-from-xrd"
      - "-role=sam.secrets.secretservice-watchdog-crz-from-xrd"
      - "-logtostderr=true"
      livenessProbe:
        exec:
          command: ["ls", "/"]
        failureThreshold: 3
        initialDelaySeconds: 5
        periodSeconds: 60
      volumeMounts:
      - mountPath: /clientcert
        name: cert
    volumes:
    - name: cert
      maddogCert:
        type: client
