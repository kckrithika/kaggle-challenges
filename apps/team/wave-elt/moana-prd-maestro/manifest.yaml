apiVersion: v1

system:
  functions:
    - name: moana-mock-maestro
      count: 1
      containers:
        - name: mock-maestro
          resources:
            limits: {cpu: 4, memory: 4G}
            requests: {cpu: 2, memory: 4G}
          env:
          - {name: JAVA_OPTS, value: '-server -XX:MaxMetaspaceSize=512m -Xmx2048m -Xms2048m'}

          image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/insights/mock-maestro-gateway:master-5-fbb57e3
          ports:
            - containerPort: 15372
              name: manage
            - containerPort: 8085
              name: http
          livenessProbe:
            httpGet: {path: /manage/health, port: 15372}
            initialDelaySeconds: 30
            periodSeconds: 60
            timeoutSeconds: 30

  loadbalancers:
    - lbname: moana-mock-maestro
      function: moana-mock-maestro
      slbEnabled: true
      nodeExposed: true
      ports:
        - port: 8001
          targetport: 8085
