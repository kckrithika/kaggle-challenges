apiVersion: v1

system:
  functions:
  - name: service-event-recorder
    count: 1
    containers:
    - name: service-event-recorder
      image: tnrp/csc-health/service-event-recorder:service-event-recorder-0000004-61527409
      ports:
      - containerPort: 10000
      resources:
        limits: { cpu: "10", memory: "5Gi" }
        requests: { cpu: "10", memory: "5Gi" }
      env:
      - name: SER_GRPC_PORT
        value: 10000
      livenessProbe:
        exec:
          command:
            - "nc -z localhost 10000"
        initialDelaySeconds: 5

  loadbalancers:
  - lbname: serviceeventrecorderlb
    function: service-event-recorder
    ports:
    - port: 80
      targetport: 10000
