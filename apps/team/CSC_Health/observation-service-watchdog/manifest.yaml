apiVersion: v1

system:
  functions:
  - name: observation-service-watchdog
    count: 1
    containers:
    - name: observation-service-watchdog
      image: tnrp/csc-health/observation-service-watchdog:observation-service-watchdog-22dc179e-3
      resources:
        limits: { cpu: "1", memory: "2Gi" }
        requests: { cpu: "1", memory: "2Gi" }
      env:
      - name: OBSWD_AJNA_ENABLED
        value: true
      - name: OBSWD_PUBLISHPRODUCTIONAVAILABILITYMETRIC
        value: true
      - name: OBSWD_LOGLEVEL
        value: debug
      command: ["/bin/sh", "-c"]
      args: ["
        export OBSWD_AJNA_FUNNELENDPOINT=http://${SFDC_METRICS_SERVICE_HOST}:${SFDC_METRICS_SERVICE_PORT} ;
        export OBSWD_AJNA_DATACENTER=${KINGDOM} ;
        export OBSWD_AJNA_DEVICE=${FUNCTION} ;
        export OBSWD_OBSERVATIONSERVICE_ENDPOINT=http://${OBSERVATIONSERVICELB_SERVICE_HOST}:${OBSERVATIONSERVICELB_SERVICE_PORT} ;
        /observation-service-watchdog
      "]
