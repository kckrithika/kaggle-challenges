apiVersion: v1

system:
  notifications:
    email:
    - electron@salesforce.com
  functions:
  - name: authz-istio-test-client
    count: 1
    annotations:
      sidecar.istio.io/inject: "true"
      traffic.sidecar.istio.io/excludeInboundPorts: "15372,8440"
      electron-opa-istio-sherpa.k8s-integration.sfdc.com/inject: enabled
    containers:
    - name: authz-istio-test-http-client
      image: ops0-artifactrepo2-0-prd.data.sfdc.net/dva/electron_client:147
      args:
      - -endpoint=authz-istio-test.service-mesh.svc.mesh.sfdc.net:7442
      - -service=http
      - -loopCount=-1
      - -loopDelayInSeconds=60
      livenessProbe:
        exec:
          command: ["/bin/true"]
        initialDelaySeconds: 30
    volumes:
    - name: tls-client-cert
      maddogCert:
        type: client
    - name: tls-server-cert
      maddogCert:
        type: server
