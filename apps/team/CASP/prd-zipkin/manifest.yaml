apiVersion: v1

system:
    notifications:
      email:
        - pteyer@salesforce.com
    functions:
    - name: zipkin-func
      count: 1
      strategy:
        type: RollingUpdate
        rollingUpdate:
          maxSurge: 0
          maxUnavailable: 1
      containers:
      - name: prd-zipkin
        image: tnrp/casp/zipkin:0.0.1-0000188-f036b4ee
        ports:
        - name: nginx
          containerPort: 8887
          hostPort: 8887
        - name: zipkin
          containerPort: 9411
          hostPort: 9411
        livenessProbe:
          httpGet:
            path: /zipkin
            port: 8887
          initialDelaySeconds: 120

    loadbalancers:
    - lbname: zipkin-node
      function: zipkin-func
      nodeExposed: true
      ports:
        - port: 9410
          targetport: 9411
        - port: 8886
          targetport: 8887
    - lbname: zipkin
      function: zipkin-func
      slbEnabled: true
      ports:
        - port: 80
          targetport: 8887
