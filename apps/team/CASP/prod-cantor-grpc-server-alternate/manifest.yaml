apiVersion: v1

system:
    notifications:
      email:
        - warden@salesforce.com
    functions:
    - name: cantor-grpc-server
      count: 2
      strategy:
        type: RollingUpdate
        rollingUpdate:
          maxSurge: 0
          maxUnavailable: 1
      containers:
      - name: prod-cantor-grpc-server-alternate
        image: dva/casp/cantor_strata:112
        ports:
        - name: cantor-grpc
          containerPort: 7443
          hostPort: 17443
        livenessProbe:
          exec:
            command:
            - /usr/bin/true
        env:
        - name: SUBDOMAIN
          value: "ops"
        - name: MYSQL_SHARDS
          value: "shared0-samminionwarden1-1-$KINGDOM.ops.sfdc.net:7015;shared0-samminionwarden2-1-$KINGDOM.ops.sfdc.net:7015;shared0-samminionwarden3-1-$KINGDOM.ops.sfdc.net:7015"
        - name: NODENAME
          valueFrom:
            fieldRef:
              fieldPath: spec.nodeName
    loadbalancers:
    - lbname: cantor
      function: cantor-grpc-server
      nodeExposed: true
      ports:
        - port: 11983
          targetport: 7443
