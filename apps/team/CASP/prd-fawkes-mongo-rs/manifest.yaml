apiVersion: v1

system:
  notifications:
    email:
      - rpothana@salesforce.com
      - sravanthi.konduru@salesforce.com
      - aborra@salesforce.com
  functions:
    - name: fawkes-mongo-rs-func
      count: 3
      strategy:
        type: RollingUpdate
        rollingUpdate:
          maxSurge: 0
          maxUnavailable: 1
      containers:
        - name: prd-fawkes-mongo-rs
          image: dva/casp/mongodb_strata:jenkins-CASP-mongodb-rs-master-7-itest
          env: 
          - name: RELEASE_VAR
            value: "7.0.0"
          ports:
            - name: http
              containerPort: 27017
              hostPort: 27017
          volumeMounts:
            - mountPath: /data/db
              name: fawkes-mongo-data
            - mountPath: /var/log/monogodb
              name: fawkes-mongo-logs
            - mountPath: /fawkes/mongo-rs-key
              name: mongo-key
              readOnly: true
          livenessProbe:
            exec:
              command: ["/bin/true"]
      volumes:
        - name: fawkes-mongo-data
          hostPath:
            path: /data/fawkes-db
        - name: fawkes-mongo-logs
          hostPath:
            path: /data/fawkes-db-logs
        - name: mongo-key
          k4aSecret:
            secretName: mongo-rs-key
