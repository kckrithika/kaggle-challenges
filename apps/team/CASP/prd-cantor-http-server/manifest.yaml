apiVersion: v1

system:
    notifications:
      email:
        - warden@salesforce.com
    functions:
    - name: cantor-http-server
      count: 1
      strategy:
        type: RollingUpdate
        rollingUpdate:
          maxSurge: 0
          maxUnavailable: 1
      containers:
      - name: prd-cantor-http-server
        image: dva/casp/cantor_http_strata:25
        ports:
        - name: cantor-http
          containerPort: 8084
          hostPort: 7021 # staying consistent with port on prod with ACL
        livenessProbe:
          exec:
            command:
            - /usr/bin/true
        env:
        - name: SUBDOMAIN
          value: "eng"
        - name: STORAGE_TYPE
          value: "grpc"
    loadbalancers:
    - lbname: cantor-service
      function: cantor-http-server
      slbEnabled: true
      ports:
        - port: 80
          targetport: 8084
