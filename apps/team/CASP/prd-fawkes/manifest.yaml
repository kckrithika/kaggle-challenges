apiVersion: v1

system:
    notifications:
      email:
        - rpothana@salesforce.com
        - sravanthi.konduru@salesforce.com
        - aborra@salesforce.com
    functions:
    - name: fawkes-func
      count: 1
      strategy:
        type: RollingUpdate
        rollingUpdate:
          maxSurge: 0
          maxUnavailable: 1
      containers:
      - name: prd-fawkes
        image: dva/casp/fawkes_strata:jenkins-CASP-fawkes-master-31-itest
        env:
        - name: BRANCH
          value: "eng_production"
        - name: HTTP_PROXY
          value: "http://public0-proxy1-0-prd.data.sfdc.net:8080"
        - name: HTTPS_PROXY
          value: "https://public0-proxy1-0-prd.data.sfdc.net:8080"
        - name: NO_PROXY
          value: "warden.sfdc.net,127.0.0.1,localhost"
        - name: RELEASE_VAR
          value: "31.0.0"
        volumeMounts:
        - mountPath: /fawkes/argus-secrets
          name: argus
          readOnly: true
        - mountPath: /fawkes/splunk-secrets
          name: splunk
          readOnly: true
        - mountPath: /fawkes/gus-secrets
          name: gus
          readOnly: true
        - mountPath: /fawkes/mongo-secrets
          name: mongo
          readOnly: true
        - mountPath: /fawkes/mongo-admin-secrets
          name: mongo-admin
          readOnly: true
        - mountPath: /var/log/st2
          name: fawkes-logs-vol
        livenessProbe:
          exec:
            command: ["/bin/true"]
      volumes:
      - name: argus
        k4aSecret:
          secretName: fawkes-argus
      - name: splunk
        k4aSecret:
          secretName: fawkes-splunk
      - name: mongo
        k4aSecret:
          secretName: fawkes-mongo
      - name: mongo-admin
        k4aSecret:
          secretName: fawkes-mongo-admin
      - name: gus
        k4aSecret:
          secretName: fawkes-gus
      - name: fawkes-logs-vol
        hostPath:
          path: /data/fawkes-logs
