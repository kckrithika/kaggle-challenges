apiVersion: v1
system:
  functions:
  - containers:
    - image: ops0-artifactrepo1-0-iad.data.sfdc.net/dva/ed-spark-driver:a0d9b8689b9c7de45d5828f622b7451e5e1d4ca1
      livenessProbe:
        exec:
          command: [ls]
        initialDelaySeconds: 5
      name: spark-engine
    count: 0
    name: ed-spark-prod
  - containers:
    - env:
      - {name: MANAGEMENT_SERVER_PORT, value: '15372'}
      - {name: LOGGING_JSON_STDOUT_LEVEL, value: ALL}
      - {name: LOGGING_STDERR_LEVEL, value: ALL}
      - {name: MOANA_SPARK_ENGINE_IMAGE, value: 'ops0-artifactrepo1-0-iad.data.sfdc.net/dva/ed-spark-driver:a0d9b8689b9c7de45d5828f622b7451e5e1d4ca1'}
      - {name: KAFKA_GROUP_ID, value: ed-jobcontroller-prod}
      - {name: DEPLOYMENT_ID, value: iad-ed-prod}
      - {name: JAVA_OPTS, value: '-server -XX:MaxMetaspaceSize=512m -Xmx2048m -Xms2048m'}
      - {name: SIZING_MEMORY_OVERHEAD, value: '1024'}
      - {name: K8S_CPU_LIMIT_APPLY, value: 'false'}
      - {name: STARTUP_JOB_ENABLED, value: 'false'}
      - {name: K8S_ADDITIONAL_JVM_ARGS, value: '-XX:+UseG1GC -verbose:gc -XX:+PrintGCDateStamps -XX:+PrintGCDetails -Xss10M'}
      - {name: HANDLED_PODS_PATTERN, value: 'cs[0-9]+'}
      - {name: HANDLED_PODS_INVERT_MATCH, value: 'true'}
      image: ops0-artifactrepo1-0-iad.data.sfdc.net/dva/insights/wave-ed-job-controller:cb97a325e4319c1cef835ca27718f40a8b06c78b
      livenessProbe:
        httpGet: {path: /manage/health, port: 15372}
        initialDelaySeconds: 90
        periodSeconds: 60
        timeoutSeconds: 30
      name: jobcontroller
      ports:
      - {containerPort: 15372, name: mgmt}
      resources:
        limits: {cpu: 2, memory: 4G}
        requests: {cpu: 2, memory: 4G}
      volumeMounts:
      - {mountPath: /home/datapool/logs, name: logvol}
      - {mountPath: /home/datapool/client-certs, name: tls-client-certs}
    count: 1
    hostnetwork: false
    identity: {serviceName: ed-spark-job-controller}
    name: jobcontroller-prod
    volumes:
    - hostPath: {path: /data/sam/wave-discovery/log/ed-job-controller}
      name: logvol
    - maddogCert: {type: server}
      name: tls-server-certs
    - maddogCert: {type: client}
      name: tls-client-certs
  notifications:
    email: [ed_ie_engineers@salesforce.com]
