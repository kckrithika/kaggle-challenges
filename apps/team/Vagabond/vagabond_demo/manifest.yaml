apiVersion: v1

system:
  functions:
  - name: prd-vagabond-cluster-1
    count: 5
    hostnetwork: true
    containers:
    - name: vagabond
      # container image/version to  run
      image: ops0-artifactrepo1-0-prd.data.sfdc.net/docker-sam/vagabond/docker-acs:sowmya.tammana-20170810
      volumeMounts:
      - mountPath: /home/sfdc-acs/logs
        name: log-volume
      - mountPath: /home/sfdc-acs/v
        name: data-volume
      - mountPath: /home/sfdc-acs/acs-config
        name: config-volume
      #args: 
      #  - --zookeeper.seedHosts=blitz1-mnds1-1-sfm.ops.sfdc.net:2181 
      #  - --redis-monitor.redis-listen-ports=1300 
      #  - --server.port=1301 
      #  - --management.port=1302
      #  - --cluster.name=sp-c1
      #  - --logging.level.minimum=ALL
      #  - --settings.path=blitz.blitz02.sfm.-.caas
      #  - --metrics.startPublisher=true
      # expose redis outside the container
      #env:
      #- name:  CAAS_DEMO3
      #  value: DATE_12_1
      ports:
      - name: service-port 
        containerPort: 8085
      - name: management-port 
        containerPort: 15372
      livenessProbe:
        httpGet:
            path: /manage/health
            port: management-port
        initialDelaySeconds: 30
        periodSeconds: 30
                
    volumes:
    - name: log-volume
      hostPath:
        path: /var/log/vagabond
    - name: data-volume
      hostPath:
        path: /data/vagabond
    - name: config-volume
      hostPath:
        path: /data/vagabond

    strategy:
      type: RollingUpdate
      rollingUpdate:
        maxSurge: 0
        maxUnavailable: 2
