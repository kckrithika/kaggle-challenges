apiVersion: v1

system:
  notifications:
    email:
      - jason.woods@salesforce.com

  functions:
    - name: aws-rddev-qpid
      serviceAccountName: qpid-g2jhtoxvmvunftop1xtfudq2c
      automountServiceAccountToken: true
      type: stateful-set
      count: 3
      containers:
        - name: qpid-broker-runtime
          image: 791719295754.dkr.ecr.us-east-2.amazonaws.com/sfci/appscale/qpid-broker-runtime:0.9.0
          ports:
            - name: amqp-port
              containerPort: 5672
            - name: http-port
              containerPort: 7022
          env:
            - name: HTTP_PORT
              value: 7022
            - name: AMQP_PORT
              value: 5672
            - name: QPID_JAVA_HEAPSZ
              value: 8g
            - name: QPID_JAVA_DIRECT_MEMORYSZ
              value: 4g 
          resources:
            limits: { cpu: "8", memory: "16Gi" }
            requests: { cpu: "8", memory: "16Gi" }
          livenessProbe:
            exec:
              command: ["/bin/true"]
            initialDelaySeconds: 10
            timeoutSeconds: 10
            periodSeconds: 60
          readinessProbe:
            exec:
              command: ["/bin/true"]
            initialDelaySeconds: 10
            timeoutSeconds: 10
      lbname: aws-rddev-qpid-lb
